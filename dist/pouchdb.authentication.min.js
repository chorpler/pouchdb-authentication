!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PouchAuthentication=e()}}(function(){return function e(t,n,r){function o(s,u){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=n[s]={exports:{}};t[s][0].call(f.exports,function(e){var n=t[s][1][e];return o(n||e)},f,f.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t,n){!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(t){return e[t]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="build/",t(t.s=16)}([function(e,t,n){"use strict";var r,o=this&&this.__extends||(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,u)}a((r=r.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){u.label=n[1];break}if(6===n[0]&&u.label<i[1]){u.label=i[1],i=n;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(n);break}i[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,o,i,s,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var u=n(3),a=n(18),c=n(1);t.getBaseUrl=function(e){var t;if(e&&e.prefix){var n=e.prefix;t=n+(n.endsWith("/")?"":"/")+e.name}else t=e.name;var r=c.parseUri(t),o=r.path,i=(o.endsWith("/")?o.substr(0,-1):o).split("/").slice(0,-1).join("/");return r.protocol+"://"+r.host+(r.port?":"+r.port:"")+i},t.getBasicAuthHeaders=function(e){var t;if(e.__opts&&e.__opts.auth)t=e.__opts.auth;else{var n=c.parseUri(e.name);(n.user||n.password)&&(t={username:n.user,password:n.password})}if(!t)return new a.Headers;var r=t.username+":"+t.password,o=u.btoa(decodeURIComponent(encodeURIComponent(r))),i=new a.Headers;return i.set("Authorization","Basic "+o),i},t.doFetch=function(e,t,n){return i(this,void 0,void 0,function(){var r,o,i,u,a;return s(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),n=c.assign(n||{}),r=t,n.body&&"string"!=typeof n.body&&(n.body=JSON.stringify(n.body)),[4,e.fetch(r,n)];case 1:return o=s.sent(),i=o.ok,[4,o.json()];case 2:if(u=s.sent(),i)return[2,u];throw new Error("fetch result not ok");case 3:throw(a=s.sent())&&"unknown_error"===a.name&&(a.message=(a.message+" "||!1)+"Unknown error!  Did you remember to enable CORS?"),a;case 4:return[2]}})})};var f=function(e){function t(t){var n=e.call(this,t)||this;return n.status=400,n.name="authentication_error",n.message="",n.error=!0,n.taken=!1,t&&(n.message=t),Error.captureStackTrace(n),n}return o(t,e),t}(Error);t.AuthError=f},function(e,t,n){"use strict";function r(e){return"$"+e}function o(e){return e.substring(1)}function i(){this._store={}}function s(e){if(this._store=new i,e&&Array.isArray(e))for(var t=0,n=e.length;t<n;t++)this.add(e[t])}function u(e,t,n){Error.call(this,n),this.status=e,this.name=t,this.message=n,this.error=!0}function a(e,t){function n(t){for(var n in e)"function"!=typeof e[n]&&(this[n]=e[n]);void 0!==t&&(this.reason=t)}return n.prototype=u.prototype,new n(t)}function c(e){var t,n,r;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],n=0,r=e.length;n<r;n++)t[n]=c(e[n]);return t}if(e instanceof Date)return e.toISOString();if(function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}(e))return function(e){if(e instanceof ArrayBuffer)return function(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),n=new Uint8Array(t),r=new Uint8Array(e);return n.set(r),t}(e);var t=e.size,n=e.type;return"function"==typeof e.slice?e.slice(0,t,n):e.webkitSlice(0,t,n)}(e);if(!function(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var n=t.constructor;return"function"==typeof n&&n instanceof n&&K.call(n)==V}(e))return e;for(n in t={},e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=c(e[n]);void 0!==o&&(t[n]=o)}return t}function f(e){var t=!1;return M()(function(n){if(t)throw new Error("once called more than once");t=!0,e.apply(this,n)})}function h(e){return M()(function(t){var n=this,r="function"==typeof(t=c(t))[t.length-1]&&t.pop(),o=new Promise(function(r,o){var i;try{var s=f(function(e,t){e?o(e):r(t)});t.push(s),(i=e.apply(n,t))&&"function"==typeof i.then&&r(i)}catch(e){o(e)}});return r&&o.then(function(e){r(null,e)},r),o})}function l(e,t){return h(M()(function(n){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var r=this;return function(e,t,n){if(e.constructor.listeners("debug").length){for(var r=["api",e.name,t],o=0;o<n.length-1;o++)r.push(n[o]);e.constructor.emit("debug",r);var i=n[n.length-1];n[n.length-1]=function(n,r){var o=["api",e.name,t];o=o.concat(n?["error",n]:["success",r]),e.constructor.emit("debug",o),i(n,r)}}}(r,e,n),this.taskqueue.isReady?t.apply(this,n):new Promise(function(t,o){r.taskqueue.addTask(function(i){i?o(i):t(r[e].apply(r,n))})})}))}function d(e,t){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r];i in e&&(n[i]=e[i])}return n}function p(e){return e}function y(e){return[{ok:e}]}function v(e,t,n){function r(){var e;++a===u&&(e=[],c.forEach(function(t){t.docs.forEach(function(n){e.push({id:t.id,docs:[n]})})}),n(null,{results:e}))}function o(){if(!(h>=f.length)){var n=Math.min(h+Q,f.length),i=f.slice(h,n);!function(n,i){n.forEach(function(n,u){var a=i+u,f=s.get(n),h=d(f[0],["atts_since","attachments"]);h.open_revs=f.map(function(e){return e.rev}),h.open_revs=h.open_revs.filter(p);var l=p;0===h.open_revs.length&&(delete h.open_revs,l=y),["revs","attachments","binary","ajax","latest"].forEach(function(e){e in t&&(h[e]=t[e])}),e.get(n,h,function(e,t){var i,s,u;i=e?[{error:e}]:l(t),s=n,u=i,c[a]={id:s,docs:u},r(),o()})})}(i,h),h+=i.length}}var i=t.docs,s=new L;i.forEach(function(e){s.has(e.id)?s.get(e.id).push(e):s.set(e.id,[e])});var u=s.size,a=0,c=new Array(u),f=[];s.forEach(function(e,t){f.push(t)});var h=0;o()}function w(){return $}function g(){var e;q.EventEmitter.call(this),this._listeners={},e=this,w()&&addEventListener("storage",function(t){e.emit(t.key)})}function b(e){if("undefined"!=typeof console&&"function"==typeof console[e]){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function m(e){var t=0;return e||(t=2e3),function(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}(e,t)}function _(e,t){b("info","The above "+e+" is totally normal. "+t)}function A(e){var t={},n=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(r){r.doc||(r.doc={});var o=n&&function(e,t,n){try{return!e(t,n)}catch(e){var r="Filter function threw: "+e.toString();return a(z,r)}}(e.filter,r.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var i in r.doc._attachments)r.doc._attachments.hasOwnProperty(i)&&(r.doc._attachments[i].stub=!0)}else delete r.doc;return!0}}function x(e){for(var t=[],n=0,r=e.length;n<r;n++)t=t.concat(e[n]);return t}function B(e){var t;if(e?"string"!=typeof e?t=a(H):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=a(Y)):t=a(N),t)throw t}function E(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(b("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function S(e,t){return"listenerCount"in e?e.listenerCount(t):q.EventEmitter.listenerCount(e,t)}function U(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function O(e){var t=U(e);return t?t.join("/"):null}function k(e){for(var t=re.exec(e),n={},r=14;r--;){var o=ee[r],i=t[r]||"",s=-1!==["user","password"].indexOf(o);n[o]=s?decodeURIComponent(i):i}return n[te]={},n[ee[12]].replace(ne,function(e,t,r){t&&(n[te][t]=r)}),n}function j(e,t){var n=[],r=[];for(var o in t)t.hasOwnProperty(o)&&(n.push(o),r.push(t[o]));return n.push(e),Function.apply(null,n).apply(null,r)}function P(e,t,n){return new Promise(function(r,o){e.get(t,function(i,s){if(i){if(404!==i.status)return o(i);s={}}var u=s._rev,a=n(s);if(!a)return r({updated:!1,rev:u});a._id=t,a._rev=u,r(function(e,t,n){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(r){if(409!==r.status)throw r;return P(e,t._id,n)})}(e,a,n))})})}function C(e,t){var n=c(e);return t?(delete n._rev_tree,Object(J.a)(JSON.stringify(n))):W.a.v4().replace(/-/g,"").toLowerCase()}n.r(t);var L,T=n(5),M=n.n(T);i.prototype.get=function(e){var t=r(e);return this._store[t]},i.prototype.set=function(e,t){var n=r(e);return this._store[n]=t,!0},i.prototype.has=function(e){return r(e)in this._store},i.prototype.delete=function(e){var t=r(e),n=t in this._store;return delete this._store[t],n},i.prototype.forEach=function(e){for(var t=Object.keys(this._store),n=0,r=t.length;n<r;n++){var i=t[n];e(this._store[i],i=o(i))}},Object.defineProperty(i.prototype,"size",{get:function(){return Object.keys(this._store).length}}),s.prototype.add=function(e){return this._store.set(e,!0)},s.prototype.has=function(e){return this._store.has(e)},s.prototype.forEach=function(e){this._store.forEach(function(t,n){e(n)})},Object.defineProperty(s.prototype,"size",{get:function(){return this._store.size}}),function(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var e=Object.getOwnPropertyDescriptor(Map,Symbol.species);return e&&"get"in e&&Map[Symbol.species]===Map}()?(Set,L=Map):L=i;var D=n(7),I=n.n(D),q=n(2),F=n(4),R=n.n(F);R()(u,Error),u.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})},new u(401,"unauthorized","Name or password is incorrect."),new u(400,"bad_request","Missing JSON list of 'docs'"),new u(404,"not_found","missing"),new u(409,"conflict","Document update conflict");var H=new u(400,"bad_request","_id field must contain a string"),N=new u(412,"missing_id","_id is required for puts"),Y=new u(400,"bad_request","Only reserved document ids may start with underscore."),z=(new u(412,"precondition_failed","Database not open"),new u(500,"unknown_error","Database encountered an unknown error"),new u(500,"badarg","Some query argument is invalid"),new u(400,"invalid_request","Request was invalid"),new u(400,"query_parse_error","Some query parameter is invalid"),new u(500,"doc_validation","Bad special document member"),new u(400,"bad_request","Something wrong with the request"));new u(400,"bad_request","Document must be a JSON object"),new u(404,"not_found","Database not found"),new u(500,"indexed_db_went_bad","unknown"),new u(500,"web_sql_went_bad","unknown"),new u(500,"levelDB_went_went_bad","unknown"),new u(403,"forbidden","Forbidden by design doc validate_doc_update function"),new u(400,"bad_request","Invalid rev format"),new u(412,"file_exists","The database could not be created, the file already exists."),new u(412,"missing_stub","A pre-existing attachment stub wasn't found"),new u(413,"invalid_url","Provided URL is invalid");var G=n(8),W=n.n(G),J=n(15);n.d(t,"adapterFun",function(){return l}),n.d(t,"assign",function(){return X}),n.d(t,"bulkGetShim",function(){return v}),n.d(t,"changesHandler",function(){return g}),n.d(t,"clone",function(){return c}),n.d(t,"defaultBackOff",function(){return m}),n.d(t,"explainError",function(){return _}),n.d(t,"filterChange",function(){return A}),n.d(t,"flatten",function(){return x}),n.d(t,"functionName",function(){return Z}),n.d(t,"guardedConsole",function(){return b}),n.d(t,"hasLocalStorage",function(){return w}),n.d(t,"invalidIdError",function(){return B}),n.d(t,"isRemote",function(){return E}),n.d(t,"listenerCount",function(){return S}),n.d(t,"normalizeDdocFunctionName",function(){return O}),n.d(t,"once",function(){return f}),n.d(t,"parseDdocFunctionName",function(){return U}),n.d(t,"parseUri",function(){return k}),n.d(t,"pick",function(){return d}),n.d(t,"rev",function(){return C}),n.d(t,"scopeEval",function(){return j}),n.d(t,"toPromise",function(){return h}),n.d(t,"upsert",function(){return P}),n.d(t,"uuid",function(){return oe}),n.d(t,"nextTick",function(){return I.a});var $,K=Function.prototype.toString,V=K.call(Object),Q=6;try{localStorage.setItem("_pouch_check_localstorage",1),$=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){$=!1}R()(g,q.EventEmitter),g.prototype.addListener=function(e,t,n,r){function o(){if(i._listeners[t])if(s)s="waiting";else{s=!0;var e=d(r,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);n.changes(e).on("change",function(e){e.seq>r.since&&!r.cancelled&&(r.since=e.seq,r.onChange(e))}).on("complete",function(){"waiting"===s&&I()(o),s=!1}).on("error",function(){s=!1})}}if(!this._listeners[t]){var i=this,s=!1;this._listeners[t]=o,this.on(e,o)}},g.prototype.removeListener=function(e,t){t in this._listeners&&(q.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},g.prototype.notifyLocalWindows=function(e){w()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},g.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};var X="function"==typeof Object.assign?Object.assign:function(e){for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},Z=function(){}.name?function(e){return e.name}:function(e){var t=e.toString().match(/^\s*function\s*(?:(\S+)\s*)?\(/);return t&&t[1]?t[1]:""},ee=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],te="queryKey",ne=/(?:^|&)([^&=]*)=?([^&]*)/g,re=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,oe=W.a.v4},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,s,u,a,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(i(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),n.apply(this,u)}else if(o(n))for(u=Array.prototype.slice.call(arguments,1),s=(c=n.slice()).length,a=0;a<s;a++)c[a].apply(this,u);return!0},n.prototype.addListener=function(e,t){var s;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(s=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var n,i,s,u;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(n=this._events[e]).length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(u=s;u-- >0;)if(n[u]===t||n[u].listener&&n[u].listener===t){i=u;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,n){"use strict";function r(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var n=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}function o(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function i(e,t){return r([o(e)],{type:t})}function s(e,t){return i(l(e),t)}function u(e,t){var n=new FileReader,r="function"==typeof n.readAsBinaryString;n.onloadend=function(e){var n=e.target.result||"";if(r)return t(n);t(function(e){for(var t="",n=new Uint8Array(e),r=n.byteLength,o=0;o<r;o++)t+=String.fromCharCode(n[o]);return t}(n))},r?n.readAsBinaryString(e):n.readAsArrayBuffer(e)}function a(e,t){u(e,function(e){t(e)})}function c(e,t){a(e,function(e){t(d(e))})}function f(e,t){var n=new FileReader;n.onloadend=function(e){var n=e.target.result||new ArrayBuffer(0);t(n)},n.readAsArrayBuffer(e)}function h(){}n.r(t),n.d(t,"atob",function(){return l}),n.d(t,"btoa",function(){return d}),n.d(t,"base64StringToBlobOrBuffer",function(){return s}),n.d(t,"binaryStringToArrayBuffer",function(){return o}),n.d(t,"binaryStringToBlobOrBuffer",function(){return i}),n.d(t,"blob",function(){return r}),n.d(t,"blobOrBufferToBase64",function(){return c}),n.d(t,"blobOrBufferToBinaryString",function(){return a}),n.d(t,"readAsArrayBuffer",function(){return f}),n.d(t,"readAsBinaryString",function(){return u}),n.d(t,"typedBuffer",function(){return h});var l=function(e){return atob(e)},d=function(e){return btoa(e)}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){"use strict";e.exports=function(e){return function(){var t=arguments.length;if(t){for(var n=[],r=-1;++r<t;)n[r]=arguments[r];return e.call(this,n)}return e.call(this,[])}}},function(e,t,n){e.exports=function(e){"use strict";function t(e,t){var n=e[0],r=e[1],o=e[2],i=e[3];o+=((i=((i+=((n=((n+=(r&o|~r&i)+t[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&o)+t[1]-389564586|0)<<12|i>>>20)+n|0)&n|~i&r)+t[2]+606105819|0,i+=((n=((n+=((r=((r+=((o=(o<<17|o>>>15)+i|0)&i|~o&n)+t[3]-1044525330|0)<<22|r>>>10)+o|0)&o|~r&i)+t[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&o)+t[5]+1200080426|0,n+=((r=((r+=((o=((o+=((i=(i<<12|i>>>20)+n|0)&n|~i&r)+t[6]-1473231341|0)<<17|o>>>15)+i|0)&i|~o&n)+t[7]-45705983|0)<<22|r>>>10)+o|0)&o|~r&i)+t[8]+1770035416|0,r+=((o=((o+=((i=((i+=((n=(n<<7|n>>>25)+r|0)&r|~n&o)+t[9]-1958414417|0)<<12|i>>>20)+n|0)&n|~i&r)+t[10]-42063|0)<<17|o>>>15)+i|0)&i|~o&n)+t[11]-1990404162|0,o+=((i=((i+=((n=((n+=((r=(r<<22|r>>>10)+o|0)&o|~r&i)+t[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&o)+t[13]-40341101|0)<<12|i>>>20)+n|0)&n|~i&r)+t[14]-1502002290|0,i+=((n=((n+=((r=((r+=((o=(o<<17|o>>>15)+i|0)&i|~o&n)+t[15]+1236535329|0)<<22|r>>>10)+o|0)&i|o&~i)+t[1]-165796510|0)<<5|n>>>27)+r|0)&o|r&~o)+t[6]-1069501632|0,n+=((r=((r+=((o=((o+=((i=(i<<9|i>>>23)+n|0)&r|n&~r)+t[11]+643717713|0)<<14|o>>>18)+i|0)&n|i&~n)+t[0]-373897302|0)<<20|r>>>12)+o|0)&i|o&~i)+t[5]-701558691|0,r+=((o=((o+=((i=((i+=((n=(n<<5|n>>>27)+r|0)&o|r&~o)+t[10]+38016083|0)<<9|i>>>23)+n|0)&r|n&~r)+t[15]-660478335|0)<<14|o>>>18)+i|0)&n|i&~n)+t[4]-405537848|0,o+=((i=((i+=((n=((n+=((r=(r<<20|r>>>12)+o|0)&i|o&~i)+t[9]+568446438|0)<<5|n>>>27)+r|0)&o|r&~o)+t[14]-1019803690|0)<<9|i>>>23)+n|0)&r|n&~r)+t[3]-187363961|0,i+=((n=((n+=((r=((r+=((o=(o<<14|o>>>18)+i|0)&n|i&~n)+t[8]+1163531501|0)<<20|r>>>12)+o|0)&i|o&~i)+t[13]-1444681467|0)<<5|n>>>27)+r|0)&o|r&~o)+t[2]-51403784|0,n+=((r=((r+=((o=((o+=((i=(i<<9|i>>>23)+n|0)&r|n&~r)+t[7]+1735328473|0)<<14|o>>>18)+i|0)&n|i&~n)+t[12]-1926607734|0)<<20|r>>>12)+o|0)^o^i)+t[5]-378558|0,r+=((o=((o+=((i=((i+=((n=(n<<4|n>>>28)+r|0)^r^o)+t[8]-2022574463|0)<<11|i>>>21)+n|0)^n^r)+t[11]+1839030562|0)<<16|o>>>16)+i|0)^i^n)+t[14]-35309556|0,o+=((i=((i+=((n=((n+=((r=(r<<23|r>>>9)+o|0)^o^i)+t[1]-1530992060|0)<<4|n>>>28)+r|0)^r^o)+t[4]+1272893353|0)<<11|i>>>21)+n|0)^n^r)+t[7]-155497632|0,i+=((n=((n+=((r=((r+=((o=(o<<16|o>>>16)+i|0)^i^n)+t[10]-1094730640|0)<<23|r>>>9)+o|0)^o^i)+t[13]+681279174|0)<<4|n>>>28)+r|0)^r^o)+t[0]-358537222|0,n+=((r=((r+=((o=((o+=((i=(i<<11|i>>>21)+n|0)^n^r)+t[3]-722521979|0)<<16|o>>>16)+i|0)^i^n)+t[6]+76029189|0)<<23|r>>>9)+o|0)^o^i)+t[9]-640364487|0,r+=((o=((o+=((i=((i+=((n=(n<<4|n>>>28)+r|0)^r^o)+t[12]-421815835|0)<<11|i>>>21)+n|0)^n^r)+t[15]+530742520|0)<<16|o>>>16)+i|0)^i^n)+t[2]-995338651|0,n+=(o^((r=(r<<23|r>>>9)+o|0)|~i))+t[0]-198630844|0,i+=(r^((n=(n<<6|n>>>26)+r|0)|~o))+t[7]+1126891415|0,o+=(n^((i=(i<<10|i>>>22)+n|0)|~r))+t[14]-1416354905|0,r+=(i^((o=(o<<15|o>>>17)+i|0)|~n))+t[5]-57434055|0,n+=(o^((r=(r<<21|r>>>11)+o|0)|~i))+t[12]+1700485571|0,i+=(r^((n=(n<<6|n>>>26)+r|0)|~o))+t[3]-1894986606|0,o+=(n^((i=(i<<10|i>>>22)+n|0)|~r))+t[10]-1051523|0,r+=(i^((o=(o<<15|o>>>17)+i|0)|~n))+t[1]-2054922799|0,n+=(o^((r=(r<<21|r>>>11)+o|0)|~i))+t[8]+1873313359|0,i+=(r^((n=(n<<6|n>>>26)+r|0)|~o))+t[15]-30611744|0,o+=(n^((i=(i<<10|i>>>22)+n|0)|~r))+t[6]-1560198380|0,r+=(i^((o=(o<<15|o>>>17)+i|0)|~n))+t[13]+1309151649|0,n+=(o^((r=(r<<21|r>>>11)+o|0)|~i))+t[4]-145523070|0,i+=(r^((n=(n<<6|n>>>26)+r|0)|~o))+t[11]-1120210379|0,o+=(n^((i=(i<<10|i>>>22)+n|0)|~r))+t[2]+718787259|0,r=((r+=(i^((o=(o<<15|o>>>17)+i|0)|~n))+t[9]-343485551|0)<<21|r>>>11)+o|0,e[0]=n+e[0]|0,e[1]=r+e[1]|0,e[2]=o+e[2]|0,e[3]=i+e[3]|0}function n(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}function r(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return n}function o(e){var r,o,i,s,u,a,c=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=c;r+=64)t(f,n(e.substring(r-64,r)));for(o=(e=e.substring(r-64)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<o;r+=1)i[r>>2]|=e.charCodeAt(r)<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(t(f,i),r=0;r<16;r+=1)i[r]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),u=parseInt(s[2],16),a=parseInt(s[1],16)||0,i[14]=u,i[15]=a,t(f,i),f}function i(e){var t,n="";for(t=0;t<4;t+=1)n+=f[e>>8*t+4&15]+f[e>>8*t&15];return n}function s(e){var t;for(t=0;t<e.length;t+=1)e[t]=i(e[t]);return e.join("")}function u(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function a(e){var t,n=[],r=e.length;for(t=0;t<r-1;t+=2)n.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,n)}function c(){this.reset()}var f=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return s(o("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(t,n){var r,o,i,s,u=this.byteLength,a=e(t,u),c=u;return void 0!==n&&(c=e(n,u)),a>c?new ArrayBuffer(0):(r=c-a,o=new ArrayBuffer(r),i=new Uint8Array(o),s=new Uint8Array(this,a,r),i.set(s),o)}}(),c.prototype.append=function(e){return this.appendBinary(u(e)),this},c.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var r,o=this._buff.length;for(r=64;r<=o;r+=64)t(this._hash,n(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},c.prototype.end=function(e){var t,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)i[t>>2]|=r.charCodeAt(t)<<(t%4<<3);return this._finish(i,o),n=s(this._hash),e&&(n=a(n)),this.reset(),n},c.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},c.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},c.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},c.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},c.prototype._finish=function(e,n){var r,o,i,s=n;if(e[s>>2]|=128<<(s%4<<3),s>55)for(t(this._hash,e),s=0;s<16;s+=1)e[s]=0;r=(r=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(r[2],16),i=parseInt(r[1],16)||0,e[14]=o,e[15]=i,t(this._hash,e)},c.hash=function(e,t){return c.hashBinary(u(e),t)},c.hashBinary=function(e,t){var n=s(o(e));return t?a(n):n},c.ArrayBuffer=function(){this.reset()},c.ArrayBuffer.prototype.append=function(e){var n,o,i,s,u,a=(o=this._buff.buffer,i=e,s=!0,(u=new Uint8Array(o.byteLength+i.byteLength)).set(new Uint8Array(o)),u.set(new Uint8Array(i),o.byteLength),u),c=a.length;for(this._length+=e.byteLength,n=64;n<=c;n+=64)t(this._hash,r(a.subarray(n-64,n)));return this._buff=n-64<c?new Uint8Array(a.buffer.slice(n-64)):new Uint8Array(0),this},c.ArrayBuffer.prototype.end=function(e){var t,n,r=this._buff,o=r.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)i[t>>2]|=r[t]<<(t%4<<3);return this._finish(i,o),n=s(this._hash),e&&(n=a(n)),this.reset(),n},c.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},c.ArrayBuffer.prototype.getState=function(){var e,t=c.prototype.getState.call(this);return t.buff=(e=t.buff,String.fromCharCode.apply(null,new Uint8Array(e))),t},c.ArrayBuffer.prototype.setState=function(e){return e.buff=function(e,t){var n,r=e.length,o=new ArrayBuffer(r),i=new Uint8Array(o);for(n=0;n<r;n+=1)i[n]=e.charCodeAt(n);return i}(e.buff),c.prototype.setState.call(this,e)},c.ArrayBuffer.prototype.destroy=c.prototype.destroy,c.ArrayBuffer.prototype._finish=c.prototype._finish,c.ArrayBuffer.hash=function(e,n){var o=s(function(e){var n,o,i,s,u,a,c=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=c;n+=64)t(f,r(e.subarray(n-64,n)));for(o=(e=n-64<c?e.subarray(n-64):new Uint8Array(0)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<o;n+=1)i[n>>2]|=e[n]<<(n%4<<3);if(i[n>>2]|=128<<(n%4<<3),n>55)for(t(f,i),n=0;n<16;n+=1)i[n]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),u=parseInt(s[2],16),a=parseInt(s[1],16)||0,i[14]=u,i[15]=a,t(f,i),f}(new Uint8Array(e)));return n?a(o):o},c}()},function(e,t,n){"use strict";(function(t){function n(){var e,t;o=!0;for(var n=f.length;n;){for(t=f,f=[],e=-1;++e<n;)t[e]();n=f.length}o=!1}var r,o,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var s=0,u=new i(n),a=t.document.createTextNode("");u.observe(a,{characterData:!0}),r=function(){a.data=s=++s%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){n(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(n,0)};else{var c=new t.MessageChannel;c.port1.onmessage=n,r=function(){c.port2.postMessage(0)}}var f=[];e.exports=function(e){1!==f.push(e)||o||r()}}).call(this,n(10))},function(e,t,n){var r=n(19),o=n(20),i=o;i.v1=r,i.v4=o,e.exports=i},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,u)}a((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){u.label=n[1];break}if(6===n[0]&&u.label<i[1]){u.label=i[1],i=n;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(n);break}i[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,o,i,s,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(0),u=n(0),a=n(0),c=n(1),f=function(e,t){return(t?"/_node/"+t:"")+"/_config"};t.getMembership=function(e){return r(this,void 0,void 0,function(){var t,n,r,i;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=this,n=a.getBaseUrl(t),r=n+"/_membership",i=c.assign({method:"GET",headers:u.getBasicAuthHeaders(t)},e.ajax||{}),[4,s.doFetch(t,r,i)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},t.signUpAdmin=function(e,t,n){return r(this,void 0,void 0,function(){var r,a,h,l,d,p,y;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),-1===["http","https"].indexOf((r=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");if(!t)throw new i.AuthError("You must provide a password");a=void 0,h=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r.getMembership(n)];case 2:return a=o.sent(),h=a.all_nodes[0],[3,4];case 3:if((l=o.sent()).error&&"illegal_database_name"===l.error)throw l;return h=void 0,[3,4];case 4:return d=f(0,h),p=(n.configUrl||d)+"/admins/"+encodeURIComponent(e),y=c.assign({method:"PUT",processData:!1,headers:u.getBasicAuthHeaders(r),body:'"'+t+'"'},n.ajax||{}),[4,s.doFetch(r,p,y)];case 5:return[2,o.sent()];case 6:throw o.sent();case 7:return[2]}})})},t.deleteAdmin=function(e,t){return r(this,void 0,void 0,function(){var n,r,a,h,l,d,p;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),-1===["http","https"].indexOf((n=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");r=void 0,a=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.getMembership(t)];case 2:return r=o.sent(),a=r.all_nodes[0],[3,4];case 3:if((h=o.sent()).error&&"illegal_database_name"===h.error)throw h;return a=void 0,[3,4];case 4:return l=f(0,a),d=(t.configUrl||l)+"/admins/"+encodeURIComponent(e),p=c.assign({method:"DELETE",processData:!1,headers:u.getBasicAuthHeaders(n)},t.ajax||{}),[4,s.doFetch(n,d,p)];case 5:return[2,o.sent()];case 6:throw o.sent();case 7:return[2]}})})}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+"-"+o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]+o[e[r++]]}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,u)}a((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){u.label=n[1];break}if(6===n[0]&&u.label<i[1]){u.label=i[1],i=n;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(n);break}i[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,o,i,s,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(0),u=n(1);t.logIn=function(e,t,n){return r(this,void 0,void 0,function(){var r,a;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),-1===["http","https"].indexOf((r=this).type()))throw new Error("pouchdb-authentication plugin only works for the http/https adapter");if(!e)throw new Error("you must provide a username");if(!t)throw new Error("you must provide a password");return a=u.assign({method:"POST",headers:u.assign({"Content-Type":"application/json"},s.getBasicAuthHeaders(r)),body:{name:e,password:t}},n.ajax||{}),[4,i.doFetch(r,"/_session",a)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},t.logOut=function(e){return r(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=this,n=u.assign({method:"DELETE",headers:s.getBasicAuthHeaders(t)},e.ajax||{}),[4,i.doFetch(t,"/_session",n)];case 1:return[2,r.sent()];case 2:throw r.sent();case 3:return[2]}})})},t.getSession=function(){return r(this,void 0,void 0,function(){var e,t;return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=this,t={method:"GET",headers:s.getBasicAuthHeaders(e)},[4,i.doFetch(e,"/_session",t)];case 1:return[2,n.sent()];case 2:throw n.sent();case 3:return[2]}})})}},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function u(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,u)}a((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(n){return function(s){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,o&&(i=2&n[0]?o.return:n[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,n[1])).done)return i;switch(o=0,i&&(n=[2&n[0],i.value]),n[0]){case 0:case 1:i=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!i||n[1]>i[0]&&n[1]<i[3])){u.label=n[1];break}if(6===n[0]&&u.label<i[1]){u.label=i[1],i=n;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(n);break}i[2]&&u.ops.pop(),u.trys.pop();continue}n=t.call(e,u)}catch(e){n=[6,e],o=0}finally{r=i=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,s])}}var r,o,i,s,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),s=n(0),u=n(0),a=n(0),c=n(1),f=n(1);t.getUsersDatabaseUrl=function(){return a.getBaseUrl(this)+"/_users"};var h=function(e,t,n){return r(this,void 0,void 0,function(){var r,a,f,h;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),r=["_id","_rev","name","type","roles","password","password_scheme","iterations","derived_key","salt"],n.metadata){for(a in n.metadata)if(n.metadata.hasOwnProperty(a)&&-1!==r.indexOf(a))throw new i.AuthError('cannot use reserved word in metadata: "'+a+'"');t=c.assign(t,n.metadata)}return n.roles&&(t=c.assign(t,{roles:n.roles})),f="/_users/"+encodeURIComponent(t._id),h=c.assign({method:"PUT",body:t,headers:u.getBasicAuthHeaders(e)},n.ajax||{}),[4,s.doFetch(e,f,h)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})};t.signUp=function(e,t,n){return r(this,void 0,void 0,function(){var r;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),-1===["http","https"].indexOf((r=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");if(!t)throw new i.AuthError("You must provide a password");return[4,h(r,{name:e,password:t,roles:[],type:"user",_id:"org.couchdb.user:"+e},n)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},t.getUser=function(e,t){return r(this,void 0,void 0,function(){var n,r,a;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),n=this,!e)throw new i.AuthError("you must provide a username");return r="/_users/"+encodeURIComponent("org.couchdb.user:"+e),a=c.assign({method:"GET",headers:u.getBasicAuthHeaders(n)},t.ajax||{}),[4,s.doFetch(n,r,a)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},t.putUser=function(e,t){return r(this,void 0,void 0,function(){var n,r;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),-1===["http","https"].indexOf((n=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");return[4,n.getUser(e,t)];case 1:return r=o.sent(),[4,h(n,r,t)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}})})},t.deleteUser=function(e,t){return r(this,void 0,void 0,function(){var n,r,a,f;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),-1===["http","https"].indexOf((n=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");return[4,n.getUser(e,t)];case 1:return r=o.sent(),a="/_users/"+encodeURIComponent(r._id)+"?rev="+r._rev,f=c.assign({method:"DELETE",headers:u.getBasicAuthHeaders(n)},t.ajax||{}),[4,s.doFetch(n,a,f)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}})})},t.changePassword=function(e,t,n){return r(this,void 0,void 0,function(){var r,a,f,h;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),-1===["http","https"].indexOf((r=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");if(!t)throw new i.AuthError("You must provide a password");return[4,r.getUser(e,n)];case 1:return(a=o.sent()).password=t,f="/_users/"+encodeURIComponent(a._id),h=c.assign({method:"PUT",headers:u.getBasicAuthHeaders(r),body:a},n.ajax||{}),[4,s.doFetch(r,f,h)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}})})},t.changeUsername=function(e,t,n){return r(this,void 0,void 0,function(){var a,h,l,d,p,y,v;return o(this,function(w){switch(w.label){case 0:if(w.trys.push([0,11,,12]),a=this,h="org.couchdb.user:",l=function(e,t){return r(this,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,s.doFetch(a,e,t)];case 1:return[2,n.sent()];case 2:throw n.sent();case 3:return[2]}})})},d=function(e,t){return r(this,void 0,void 0,function(){var n,r;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),n="/_users/"+encodeURIComponent(e._id),r=c.assign({method:"PUT",headers:u.getBasicAuthHeaders(a),body:e},t.ajax||{}),[4,l(n,r)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},n.ajax=n.ajax||{},-1===["http","https"].indexOf(a.type()))throw p=new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!t)throw p=new i.AuthError("You must provide a new username");if(!e)throw p=new i.AuthError("You must provide a username to rename");w.label=1;case 1:return w.trys.push([1,3,,10]),[4,a.getUser(t,n)];case 2:throw w.sent(),(p=new i.AuthError("user already exists")).taken=!0,p;case 3:w.sent(),w.label=4;case 4:return w.trys.push([4,8,,9]),[4,a.getUser(e,n)];case 5:return y=w.sent(),delete(v=f.clone(y))._rev,v._id=h+t,v.name=t,v.roles=n.roles||y.roles||[],[4,d(v,n)];case 6:return w.sent(),y._deleted=!0,[4,d(y,n)];case 7:return[2,w.sent()];case 8:throw w.sent();case 9:return[3,10];case 10:return[3,12];case 11:throw w.sent();case 12:return[2]}})})}},function(e,t,n){"use strict";(function(e){function r(e){return i.a.hash(e)}n.d(t,"a",function(){return r}),n(3);var o=n(6),i=n.n(o);e.setImmediate||e.setTimeout}).call(this,n(10))},function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0});var o=n(17);r(n(9)),r(n(13)),r(n(14)),r(n(0)),t.default=o.plugin},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=n(13),i=n(14);t.plugin={},t.plugin.login=o.logIn,t.plugin.logIn=o.logIn,t.plugin.logout=o.logOut,t.plugin.logOut=o.logOut,t.plugin.getSession=o.getSession,t.plugin.getMembership=r.getMembership,t.plugin.signUpAdmin=r.signUpAdmin,t.plugin.deleteAdmin=r.deleteAdmin,t.plugin.getUsersDatabaseUrl=i.getUsersDatabaseUrl,t.plugin.signup=i.signUp,t.plugin.signUp=i.signUp,t.plugin.getUser=i.getUser,t.plugin.putUser=i.putUser,t.plugin.deleteUser=i.deleteUser,t.plugin.changePassword=i.changePassword,t.plugin.changeUsername=i.changeUsername,"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(t.plugin)},function(e,t,n){"use strict";n.r(t),n.d(t,"fetch",function(){return o}),n.d(t,"Headers",function(){return i}),n.d(t,"AbortController",function(){return r});var r="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},o=fetch,i=Headers},function(e,t,n){var r,o,i=n(11),s=n(12),u=0,a=0;e.exports=function(e,t,n){var c=t&&n||0,f=t||[],h=(e=e||{}).node||r,l=void 0!==e.clockseq?e.clockseq:o;if(null==h||null==l){var d=i();null==h&&(h=r=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==l&&(l=o=16383&(d[6]<<8|d[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:a+1,v=p-u+(y-a)/1e4;if(v<0&&void 0===e.clockseq&&(l=l+1&16383),(v<0||p>u)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=p,a=y,o=l;var w=(1e4*(268435455&(p+=122192928e5))+y)%4294967296;f[c++]=w>>>24&255,f[c++]=w>>>16&255,f[c++]=w>>>8&255,f[c++]=255&w;var g=p/4294967296*1e4&268435455;f[c++]=g>>>8&255,f[c++]=255&g,f[c++]=g>>>24&15|16,f[c++]=g>>>16&255,f[c++]=l>>>8|128,f[c++]=255&l;for(var b=0;b<6;++b)f[c+b]=h[b];return t||s(f)}},function(e,t,n){var r=n(11),o=n(12);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var u=0;u<16;++u)t[i+u]=s[u];return t||o(s)}}])},{}]},{},[1])(1)});
