!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).PouchAuthentication=e()}}(function(){return function e(t,r,n){function o(s,u){if(!r[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var f=r[s]={exports:{}};t[s][0].call(f.exports,function(e){var r=t[s][1][e];return o(r||e)},f,f.exports,e,t,r,n)}return r[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,r){!function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(t){return e[t]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="build/",t(t.s=13)}([function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),i=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,u)}a((n=n.apply(e,t||[])).next())})},s=this&&this.__generator||function(e,t){function r(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,o=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}var n,o,i,s,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var u=r(3),a=r(15),c=r(1);t.getBaseUrl=function(e){var t;if(e&&e.prefix){var r=e.prefix;t=r+(r.endsWith("/")?"":"/")+e.name}else t=e.name;var n=c.parseUri(t),o=n.path,i=(o.endsWith("/")?o.substr(0,-1):o).split("/").slice(0,-1).join("/");return n.protocol+"://"+n.host+(n.port?":"+n.port:"")+i},t.getBasicAuthHeaders=function(e){var t;if(e.__opts&&e.__opts.auth)t=e.__opts.auth;else{var r=c.parseUri(e.name);(r.user||r.password)&&(t={username:r.user,password:r.password})}if(!t)return new a.Headers;var n=t.username+":"+t.password,o=u.btoa(decodeURIComponent(encodeURIComponent(n))),i=new a.Headers;return i.set("Authorization","Basic "+o),i},t.doFetch=function(e,t,r){return i(this,void 0,void 0,function(){var n,o,i,u,a;return s(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),r=c.assign(r||{}),n=t,r.body&&"string"!=typeof r.body&&(r.body=JSON.stringify(r.body)),[4,e.fetch(n,r)];case 1:return o=s.sent(),i=o.ok,[4,o.json()];case 2:if(u=s.sent(),i)return[2,u];throw new Error("fetch result not ok");case 3:throw(a=s.sent())&&"unknown_error"===a.name&&(a.message=(a.message+" "||!1)+"Unknown error!  Did you remember to enable CORS?"),a;case 4:return[2]}})})};var f=function(e){function t(t){var r=e.call(this,t)||this;return r.status=400,r.name="authentication_error",r.message="",r.error=!0,r.taken=!1,t&&(r.message=t),Error.captureStackTrace(r),r}return o(t,e),t}(Error);t.AuthError=f},function(e,t,r){"use strict";function n(e){return"$"+e}function o(e){return e.substring(1)}function i(){this._store={}}function s(e){if(this._store=new i,e&&Array.isArray(e))for(var t=0,r=e.length;t<r;t++)this.add(e[t])}function u(e,t,r){Error.call(this,r),this.status=e,this.name=t,this.message=r,this.error=!0}function a(e,t){function r(t){for(var r in e)"function"!=typeof e[r]&&(this[r]=e[r]);void 0!==t&&(this.reason=t)}return r.prototype=u.prototype,new r(t)}function c(e){var t,r,n;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(t=[],r=0,n=e.length;r<n;r++)t[r]=c(e[r]);return t}if(e instanceof Date)return e.toISOString();if(function(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}(e))return function(e){if(e instanceof ArrayBuffer)return function(e){if("function"==typeof e.slice)return e.slice(0);var t=new ArrayBuffer(e.byteLength),r=new Uint8Array(t),n=new Uint8Array(e);return r.set(n),t}(e);var t=e.size,r=e.type;return"function"==typeof e.slice?e.slice(0,t,r):e.webkitSlice(0,t,r)}(e);if(!function(e){var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=t.constructor;return"function"==typeof r&&r instanceof r&&K.call(r)==V}(e))return e;for(r in t={},e)if(Object.prototype.hasOwnProperty.call(e,r)){var o=c(e[r]);void 0!==o&&(t[r]=o)}return t}function f(e){var t=!1;return M()(function(r){if(t)throw new Error("once called more than once");t=!0,e.apply(this,r)})}function h(e){return M()(function(t){var r=this,n="function"==typeof(t=c(t))[t.length-1]&&t.pop(),o=new Promise(function(n,o){var i;try{var s=f(function(e,t){e?o(e):n(t)});t.push(s),(i=e.apply(r,t))&&"function"==typeof i.then&&n(i)}catch(e){o(e)}});return n&&o.then(function(e){n(null,e)},n),o})}function l(e,t){return h(M()(function(r){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var n=this;return function(e,t,r){if(e.constructor.listeners("debug").length){for(var n=["api",e.name,t],o=0;o<r.length-1;o++)n.push(r[o]);e.constructor.emit("debug",n);var i=r[r.length-1];r[r.length-1]=function(r,n){var o=["api",e.name,t];o=o.concat(r?["error",r]:["success",n]),e.constructor.emit("debug",o),i(r,n)}}}(n,e,r),this.taskqueue.isReady?t.apply(this,r):new Promise(function(t,o){n.taskqueue.addTask(function(i){i?o(i):t(n[e].apply(n,r))})})}))}function d(e,t){for(var r={},n=0,o=t.length;n<o;n++){var i=t[n];i in e&&(r[i]=e[i])}return r}function p(e){return e}function y(e){return[{ok:e}]}function v(e,t,r){function n(){var e;++a===u&&(e=[],c.forEach(function(t){t.docs.forEach(function(r){e.push({id:t.id,docs:[r]})})}),r(null,{results:e}))}function o(){if(!(h>=f.length)){var r=Math.min(h+Q,f.length),i=f.slice(h,r);!function(r,i){r.forEach(function(r,u){var a=i+u,f=s.get(r),h=d(f[0],["atts_since","attachments"]);h.open_revs=f.map(function(e){return e.rev}),h.open_revs=h.open_revs.filter(p);var l=p;0===h.open_revs.length&&(delete h.open_revs,l=y),["revs","attachments","binary","ajax","latest"].forEach(function(e){e in t&&(h[e]=t[e])}),e.get(r,h,function(e,t){var i,s,u;i=e?[{error:e}]:l(t),s=r,u=i,c[a]={id:s,docs:u},n(),o()})})}(i,h),h+=i.length}}var i=t.docs,s=new L;i.forEach(function(e){s.has(e.id)?s.get(e.id).push(e):s.set(e.id,[e])});var u=s.size,a=0,c=new Array(u),f=[];s.forEach(function(e,t){f.push(t)});var h=0;o()}function w(){return $}function b(){var e;q.EventEmitter.call(this),this._listeners={},e=this,w()&&addEventListener("storage",function(t){e.emit(t.key)})}function g(e){if("undefined"!=typeof console&&"function"==typeof console[e]){var t=Array.prototype.slice.call(arguments,1);console[e].apply(console,t)}}function m(e){var t=0;return e||(t=2e3),function(e,t){return e=parseInt(e,10)||0,(t=parseInt(t,10))!=t||t<=e?t=(e||1)<<1:t+=1,t>6e5&&(e=3e5,t=6e5),~~((t-e)*Math.random()+e)}(e,t)}function _(e,t){g("info","The above "+e+" is totally normal. "+t)}function A(e){var t={},r=e.filter&&"function"==typeof e.filter;return t.query=e.query_params,function(n){n.doc||(n.doc={});var o=r&&function(e,t,r){try{return!e(t,r)}catch(e){var n="Filter function threw: "+e.toString();return a(z,n)}}(e.filter,n.doc,t);if("object"==typeof o)return o;if(o)return!1;if(e.include_docs){if(!e.attachments)for(var i in n.doc._attachments)n.doc._attachments.hasOwnProperty(i)&&(n.doc._attachments[i].stub=!0)}else delete n.doc;return!0}}function x(e){for(var t=[],r=0,n=e.length;r<n;r++)t=t.concat(e[r]);return t}function B(e){var t;if(e?"string"!=typeof e?t=a(H):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(t=a(Y)):t=a(N),t)throw t}function E(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(g("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function S(e,t){return"listenerCount"in e?e.listenerCount(t):q.EventEmitter.listenerCount(e,t)}function U(e){if(!e)return null;var t=e.split("/");return 2===t.length?t:1===t.length?[e,e]:null}function O(e){var t=U(e);return t?t.join("/"):null}function k(e){for(var t=ne.exec(e),r={},n=14;n--;){var o=ee[n],i=t[n]||"",s=-1!==["user","password"].indexOf(o);r[o]=s?decodeURIComponent(i):i}return r[te]={},r[ee[12]].replace(re,function(e,t,n){t&&(r[te][t]=n)}),r}function j(e,t){var r=[],n=[];for(var o in t)t.hasOwnProperty(o)&&(r.push(o),n.push(t[o]));return r.push(e),Function.apply(null,r).apply(null,n)}function P(e,t,r){return new Promise(function(n,o){e.get(t,function(i,s){if(i){if(404!==i.status)return o(i);s={}}var u=s._rev,a=r(s);if(!a)return n({updated:!1,rev:u});a._id=t,a._rev=u,n(function(e,t,r){return e.put(t).then(function(e){return{updated:!0,rev:e.rev}},function(n){if(409!==n.status)throw n;return P(e,t._id,r)})}(e,a,r))})})}function C(e,t){var r=c(e);return t?(delete r._rev_tree,Object(J.a)(JSON.stringify(r))):W.a.v4().replace(/-/g,"").toLowerCase()}r.r(t);var L,T=r(5),M=r.n(T);i.prototype.get=function(e){var t=n(e);return this._store[t]},i.prototype.set=function(e,t){var r=n(e);return this._store[r]=t,!0},i.prototype.has=function(e){return n(e)in this._store},i.prototype.delete=function(e){var t=n(e),r=t in this._store;return delete this._store[t],r},i.prototype.forEach=function(e){for(var t=Object.keys(this._store),r=0,n=t.length;r<n;r++){var i=t[r];e(this._store[i],i=o(i))}},Object.defineProperty(i.prototype,"size",{get:function(){return Object.keys(this._store).length}}),s.prototype.add=function(e){return this._store.set(e,!0)},s.prototype.has=function(e){return this._store.has(e)},s.prototype.forEach=function(e){this._store.forEach(function(t,r){e(r)})},Object.defineProperty(s.prototype,"size",{get:function(){return this._store.size}}),function(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var e=Object.getOwnPropertyDescriptor(Map,Symbol.species);return e&&"get"in e&&Map[Symbol.species]===Map}()?(Set,L=Map):L=i;var D=r(7),I=r.n(D),q=r(2),F=r(4),R=r.n(F);R()(u,Error),u.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})},new u(401,"unauthorized","Name or password is incorrect."),new u(400,"bad_request","Missing JSON list of 'docs'"),new u(404,"not_found","missing"),new u(409,"conflict","Document update conflict");var H=new u(400,"bad_request","_id field must contain a string"),N=new u(412,"missing_id","_id is required for puts"),Y=new u(400,"bad_request","Only reserved document ids may start with underscore."),z=(new u(412,"precondition_failed","Database not open"),new u(500,"unknown_error","Database encountered an unknown error"),new u(500,"badarg","Some query argument is invalid"),new u(400,"invalid_request","Request was invalid"),new u(400,"query_parse_error","Some query parameter is invalid"),new u(500,"doc_validation","Bad special document member"),new u(400,"bad_request","Something wrong with the request"));new u(400,"bad_request","Document must be a JSON object"),new u(404,"not_found","Database not found"),new u(500,"indexed_db_went_bad","unknown"),new u(500,"web_sql_went_bad","unknown"),new u(500,"levelDB_went_went_bad","unknown"),new u(403,"forbidden","Forbidden by design doc validate_doc_update function"),new u(400,"bad_request","Invalid rev format"),new u(412,"file_exists","The database could not be created, the file already exists."),new u(412,"missing_stub","A pre-existing attachment stub wasn't found"),new u(413,"invalid_url","Provided URL is invalid");var G=r(8),W=r.n(G),J=r(12);r.d(t,"adapterFun",function(){return l}),r.d(t,"assign",function(){return X}),r.d(t,"bulkGetShim",function(){return v}),r.d(t,"changesHandler",function(){return b}),r.d(t,"clone",function(){return c}),r.d(t,"defaultBackOff",function(){return m}),r.d(t,"explainError",function(){return _}),r.d(t,"filterChange",function(){return A}),r.d(t,"flatten",function(){return x}),r.d(t,"functionName",function(){return Z}),r.d(t,"guardedConsole",function(){return g}),r.d(t,"hasLocalStorage",function(){return w}),r.d(t,"invalidIdError",function(){return B}),r.d(t,"isRemote",function(){return E}),r.d(t,"listenerCount",function(){return S}),r.d(t,"normalizeDdocFunctionName",function(){return O}),r.d(t,"once",function(){return f}),r.d(t,"parseDdocFunctionName",function(){return U}),r.d(t,"parseUri",function(){return k}),r.d(t,"pick",function(){return d}),r.d(t,"rev",function(){return C}),r.d(t,"scopeEval",function(){return j}),r.d(t,"toPromise",function(){return h}),r.d(t,"upsert",function(){return P}),r.d(t,"uuid",function(){return oe}),r.d(t,"nextTick",function(){return I.a});var $,K=Function.prototype.toString,V=K.call(Object),Q=6;try{localStorage.setItem("_pouch_check_localstorage",1),$=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){$=!1}R()(b,q.EventEmitter),b.prototype.addListener=function(e,t,r,n){function o(){if(i._listeners[t])if(s)s="waiting";else{s=!0;var e=d(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);r.changes(e).on("change",function(e){e.seq>n.since&&!n.cancelled&&(n.since=e.seq,n.onChange(e))}).on("complete",function(){"waiting"===s&&I()(o),s=!1}).on("error",function(){s=!1})}}if(!this._listeners[t]){var i=this,s=!1;this._listeners[t]=o,this.on(e,o)}},b.prototype.removeListener=function(e,t){t in this._listeners&&(q.EventEmitter.prototype.removeListener.call(this,e,this._listeners[t]),delete this._listeners[t])},b.prototype.notifyLocalWindows=function(e){w()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},b.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};var X="function"==typeof Object.assign?Object.assign:function(e){for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Z=function(){}.name?function(e){return e.name}:function(e){var t=e.toString().match(/^\s*function\s*(?:(\S+)\s*)?\(/);return t&&t[1]?t[1]:""},ee=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],te="queryKey",re=/(?:^|&)([^&=]*)=?([^&]*)/g,ne=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,oe=W.a.v4},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,s,u,a,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var f=new Error('Uncaught, unspecified "error" event. ('+t+")");throw f.context=t,f}if(i(r=this._events[e]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),r.apply(this,u)}else if(o(r))for(u=Array.prototype.slice.call(arguments,1),s=(c=r.slice()).length,a=0;a<s;a++)c[a].apply(this,u);return!0},r.prototype.addListener=function(e,t){var s;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(s=i(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),o||(o=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var o=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,i,s,u;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(r=this._events[e]).length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(u=s;u-- >0;)if(r[u]===t||r[u].listener&&r[u].listener===t){i=u;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";function n(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}function o(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),o=0;o<t;o++)n[o]=e.charCodeAt(o);return r}function i(e,t){return n([o(e)],{type:t})}function s(e,t){return i(l(e),t)}function u(e,t){var r=new FileReader,n="function"==typeof r.readAsBinaryString;r.onloadend=function(e){var r=e.target.result||"";if(n)return t(r);t(function(e){for(var t="",r=new Uint8Array(e),n=r.byteLength,o=0;o<n;o++)t+=String.fromCharCode(r[o]);return t}(r))},n?r.readAsBinaryString(e):r.readAsArrayBuffer(e)}function a(e,t){u(e,function(e){t(e)})}function c(e,t){a(e,function(e){t(d(e))})}function f(e,t){var r=new FileReader;r.onloadend=function(e){var r=e.target.result||new ArrayBuffer(0);t(r)},r.readAsArrayBuffer(e)}function h(){}r.r(t),r.d(t,"atob",function(){return l}),r.d(t,"btoa",function(){return d}),r.d(t,"base64StringToBlobOrBuffer",function(){return s}),r.d(t,"binaryStringToArrayBuffer",function(){return o}),r.d(t,"binaryStringToBlobOrBuffer",function(){return i}),r.d(t,"blob",function(){return n}),r.d(t,"blobOrBufferToBase64",function(){return c}),r.d(t,"blobOrBufferToBinaryString",function(){return a}),r.d(t,"readAsArrayBuffer",function(){return f}),r.d(t,"readAsBinaryString",function(){return u}),r.d(t,"typedBuffer",function(){return h});var l=function(e){return atob(e)},d=function(e){return btoa(e)}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";e.exports=function(e){return function(){var t=arguments.length;if(t){for(var r=[],n=-1;++n<t;)r[n]=arguments[n];return e.call(this,r)}return e.call(this,[])}}},function(e,t,r){e.exports=function(e){"use strict";function t(e,t){var r=e[0],n=e[1],o=e[2],i=e[3];o+=((i=((i+=((r=((r+=(n&o|~n&i)+t[0]-680876936|0)<<7|r>>>25)+n|0)&n|~r&o)+t[1]-389564586|0)<<12|i>>>20)+r|0)&r|~i&n)+t[2]+606105819|0,i+=((r=((r+=((n=((n+=((o=(o<<17|o>>>15)+i|0)&i|~o&r)+t[3]-1044525330|0)<<22|n>>>10)+o|0)&o|~n&i)+t[4]-176418897|0)<<7|r>>>25)+n|0)&n|~r&o)+t[5]+1200080426|0,r+=((n=((n+=((o=((o+=((i=(i<<12|i>>>20)+r|0)&r|~i&n)+t[6]-1473231341|0)<<17|o>>>15)+i|0)&i|~o&r)+t[7]-45705983|0)<<22|n>>>10)+o|0)&o|~n&i)+t[8]+1770035416|0,n+=((o=((o+=((i=((i+=((r=(r<<7|r>>>25)+n|0)&n|~r&o)+t[9]-1958414417|0)<<12|i>>>20)+r|0)&r|~i&n)+t[10]-42063|0)<<17|o>>>15)+i|0)&i|~o&r)+t[11]-1990404162|0,o+=((i=((i+=((r=((r+=((n=(n<<22|n>>>10)+o|0)&o|~n&i)+t[12]+1804603682|0)<<7|r>>>25)+n|0)&n|~r&o)+t[13]-40341101|0)<<12|i>>>20)+r|0)&r|~i&n)+t[14]-1502002290|0,i+=((r=((r+=((n=((n+=((o=(o<<17|o>>>15)+i|0)&i|~o&r)+t[15]+1236535329|0)<<22|n>>>10)+o|0)&i|o&~i)+t[1]-165796510|0)<<5|r>>>27)+n|0)&o|n&~o)+t[6]-1069501632|0,r+=((n=((n+=((o=((o+=((i=(i<<9|i>>>23)+r|0)&n|r&~n)+t[11]+643717713|0)<<14|o>>>18)+i|0)&r|i&~r)+t[0]-373897302|0)<<20|n>>>12)+o|0)&i|o&~i)+t[5]-701558691|0,n+=((o=((o+=((i=((i+=((r=(r<<5|r>>>27)+n|0)&o|n&~o)+t[10]+38016083|0)<<9|i>>>23)+r|0)&n|r&~n)+t[15]-660478335|0)<<14|o>>>18)+i|0)&r|i&~r)+t[4]-405537848|0,o+=((i=((i+=((r=((r+=((n=(n<<20|n>>>12)+o|0)&i|o&~i)+t[9]+568446438|0)<<5|r>>>27)+n|0)&o|n&~o)+t[14]-1019803690|0)<<9|i>>>23)+r|0)&n|r&~n)+t[3]-187363961|0,i+=((r=((r+=((n=((n+=((o=(o<<14|o>>>18)+i|0)&r|i&~r)+t[8]+1163531501|0)<<20|n>>>12)+o|0)&i|o&~i)+t[13]-1444681467|0)<<5|r>>>27)+n|0)&o|n&~o)+t[2]-51403784|0,r+=((n=((n+=((o=((o+=((i=(i<<9|i>>>23)+r|0)&n|r&~n)+t[7]+1735328473|0)<<14|o>>>18)+i|0)&r|i&~r)+t[12]-1926607734|0)<<20|n>>>12)+o|0)^o^i)+t[5]-378558|0,n+=((o=((o+=((i=((i+=((r=(r<<4|r>>>28)+n|0)^n^o)+t[8]-2022574463|0)<<11|i>>>21)+r|0)^r^n)+t[11]+1839030562|0)<<16|o>>>16)+i|0)^i^r)+t[14]-35309556|0,o+=((i=((i+=((r=((r+=((n=(n<<23|n>>>9)+o|0)^o^i)+t[1]-1530992060|0)<<4|r>>>28)+n|0)^n^o)+t[4]+1272893353|0)<<11|i>>>21)+r|0)^r^n)+t[7]-155497632|0,i+=((r=((r+=((n=((n+=((o=(o<<16|o>>>16)+i|0)^i^r)+t[10]-1094730640|0)<<23|n>>>9)+o|0)^o^i)+t[13]+681279174|0)<<4|r>>>28)+n|0)^n^o)+t[0]-358537222|0,r+=((n=((n+=((o=((o+=((i=(i<<11|i>>>21)+r|0)^r^n)+t[3]-722521979|0)<<16|o>>>16)+i|0)^i^r)+t[6]+76029189|0)<<23|n>>>9)+o|0)^o^i)+t[9]-640364487|0,n+=((o=((o+=((i=((i+=((r=(r<<4|r>>>28)+n|0)^n^o)+t[12]-421815835|0)<<11|i>>>21)+r|0)^r^n)+t[15]+530742520|0)<<16|o>>>16)+i|0)^i^r)+t[2]-995338651|0,r+=(o^((n=(n<<23|n>>>9)+o|0)|~i))+t[0]-198630844|0,i+=(n^((r=(r<<6|r>>>26)+n|0)|~o))+t[7]+1126891415|0,o+=(r^((i=(i<<10|i>>>22)+r|0)|~n))+t[14]-1416354905|0,n+=(i^((o=(o<<15|o>>>17)+i|0)|~r))+t[5]-57434055|0,r+=(o^((n=(n<<21|n>>>11)+o|0)|~i))+t[12]+1700485571|0,i+=(n^((r=(r<<6|r>>>26)+n|0)|~o))+t[3]-1894986606|0,o+=(r^((i=(i<<10|i>>>22)+r|0)|~n))+t[10]-1051523|0,n+=(i^((o=(o<<15|o>>>17)+i|0)|~r))+t[1]-2054922799|0,r+=(o^((n=(n<<21|n>>>11)+o|0)|~i))+t[8]+1873313359|0,i+=(n^((r=(r<<6|r>>>26)+n|0)|~o))+t[15]-30611744|0,o+=(r^((i=(i<<10|i>>>22)+r|0)|~n))+t[6]-1560198380|0,n+=(i^((o=(o<<15|o>>>17)+i|0)|~r))+t[13]+1309151649|0,r+=(o^((n=(n<<21|n>>>11)+o|0)|~i))+t[4]-145523070|0,i+=(n^((r=(r<<6|r>>>26)+n|0)|~o))+t[11]-1120210379|0,o+=(r^((i=(i<<10|i>>>22)+r|0)|~n))+t[2]+718787259|0,n=((n+=(i^((o=(o<<15|o>>>17)+i|0)|~r))+t[9]-343485551|0)<<21|n>>>11)+o|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=o+e[2]|0,e[3]=i+e[3]|0}function r(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}function n(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return r}function o(e){var n,o,i,s,u,a,c=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=c;n+=64)t(f,r(e.substring(n-64,n)));for(o=(e=e.substring(n-64)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],n=0;n<o;n+=1)i[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(i[n>>2]|=128<<(n%4<<3),n>55)for(t(f,i),n=0;n<16;n+=1)i[n]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),u=parseInt(s[2],16),a=parseInt(s[1],16)||0,i[14]=u,i[15]=a,t(f,i),f}function i(e){var t,r="";for(t=0;t<4;t+=1)r+=f[e>>8*t+4&15]+f[e>>8*t&15];return r}function s(e){var t;for(t=0;t<e.length;t+=1)e[t]=i(e[t]);return e.join("")}function u(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function a(e){var t,r=[],n=e.length;for(t=0;t<n-1;t+=2)r.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,r)}function c(){this.reset()}var f=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];return s(o("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(t,r){var n,o,i,s,u=this.byteLength,a=e(t,u),c=u;return void 0!==r&&(c=e(r,u)),a>c?new ArrayBuffer(0):(n=c-a,o=new ArrayBuffer(n),i=new Uint8Array(o),s=new Uint8Array(this,a,n),i.set(s),o)}}(),c.prototype.append=function(e){return this.appendBinary(u(e)),this},c.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var n,o=this._buff.length;for(n=64;n<=o;n+=64)t(this._hash,r(this._buff.substring(n-64,n)));return this._buff=this._buff.substring(n-64),this},c.prototype.end=function(e){var t,r,n=this._buff,o=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)i[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(i,o),r=s(this._hash),e&&(r=a(r)),this.reset(),r},c.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},c.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},c.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},c.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},c.prototype._finish=function(e,r){var n,o,i,s=r;if(e[s>>2]|=128<<(s%4<<3),s>55)for(t(this._hash,e),s=0;s<16;s+=1)e[s]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(n[2],16),i=parseInt(n[1],16)||0,e[14]=o,e[15]=i,t(this._hash,e)},c.hash=function(e,t){return c.hashBinary(u(e),t)},c.hashBinary=function(e,t){var r=s(o(e));return t?a(r):r},c.ArrayBuffer=function(){this.reset()},c.ArrayBuffer.prototype.append=function(e){var r,o,i,s,u,a=(o=this._buff.buffer,i=e,s=!0,(u=new Uint8Array(o.byteLength+i.byteLength)).set(new Uint8Array(o)),u.set(new Uint8Array(i),o.byteLength),u),c=a.length;for(this._length+=e.byteLength,r=64;r<=c;r+=64)t(this._hash,n(a.subarray(r-64,r)));return this._buff=r-64<c?new Uint8Array(a.buffer.slice(r-64)):new Uint8Array(0),this},c.ArrayBuffer.prototype.end=function(e){var t,r,n=this._buff,o=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<o;t+=1)i[t>>2]|=n[t]<<(t%4<<3);return this._finish(i,o),r=s(this._hash),e&&(r=a(r)),this.reset(),r},c.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},c.ArrayBuffer.prototype.getState=function(){var e,t=c.prototype.getState.call(this);return t.buff=(e=t.buff,String.fromCharCode.apply(null,new Uint8Array(e))),t},c.ArrayBuffer.prototype.setState=function(e){return e.buff=function(e,t){var r,n=e.length,o=new ArrayBuffer(n),i=new Uint8Array(o);for(r=0;r<n;r+=1)i[r]=e.charCodeAt(r);return i}(e.buff),c.prototype.setState.call(this,e)},c.ArrayBuffer.prototype.destroy=c.prototype.destroy,c.ArrayBuffer.prototype._finish=c.prototype._finish,c.ArrayBuffer.hash=function(e,r){var o=s(function(e){var r,o,i,s,u,a,c=e.length,f=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=c;r+=64)t(f,n(e.subarray(r-64,r)));for(o=(e=r-64<c?e.subarray(r-64):new Uint8Array(0)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<o;r+=1)i[r>>2]|=e[r]<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(t(f,i),r=0;r<16;r+=1)i[r]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),u=parseInt(s[2],16),a=parseInt(s[1],16)||0,i[14]=u,i[15]=a,t(f,i),f}(new Uint8Array(e)));return r?a(o):o},c}()},function(e,t,r){"use strict";(function(t){function r(){var e,t;o=!0;for(var r=f.length;r;){for(t=f,f=[],e=-1;++e<r;)t[e]();r=f.length}o=!1}var n,o,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var s=0,u=new i(r),a=t.document.createTextNode("");u.observe(a,{characterData:!0}),n=function(){a.data=s=++s%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){r(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(r,0)};else{var c=new t.MessageChannel;c.port1.onmessage=r,n=function(){c.port2.postMessage(0)}}var f=[];e.exports=function(e){1!==f.push(e)||o||n()}}).call(this,r(9))},function(e,t,r){var n=r(16),o=r(17),i=o;i.v1=n,i.v4=o,e.exports=i},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,o=r;return o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+"-"+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]}},function(e,t,r){"use strict";(function(e){function n(e){return i.a.hash(e)}r.d(t,"a",function(){return n}),r(3);var o=r(6),i=r.n(o);e.setImmediate||e.setTimeout}).call(this,r(9))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(18),i=r(19),s={};t.plugin=s,s.login=o.logIn,s.logIn=o.logIn,s.logout=o.logOut,s.logOut=o.logOut,s.getSession=o.getSession,s.getMembership=n.getMembership,s.signUpAdmin=n.signUpAdmin,s.deleteAdmin=n.deleteAdmin,s.getUsersDatabaseUrl=i.getUsersDatabaseUrl,s.signup=i.signUp,s.signUp=i.signUp,s.getUser=i.getUser,s.putUser=i.putUser,s.deleteUser=i.deleteUser,s.changePassword=i.changePassword,s.changeUsername=i.changeUsername,"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(s)},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,u)}a((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function r(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,o=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}var n,o,i,s,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=r(0),u=r(0),a=r(0),c=r(1),f=function(e,t){return(t?"/_node/"+t:"")+"/_config"};t.getMembership=function(e){return n(this,void 0,void 0,function(){var t,r,n,i;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=this,r=a.getBaseUrl(t),n=r+"/_membership",i=c.assign({method:"GET",headers:u.getBasicAuthHeaders(t)},e.ajax||{}),[4,s.doFetch(t,n,i)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},t.signUpAdmin=function(e,t,r){return n(this,void 0,void 0,function(){var n,a,h,l,d,p,y;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),-1===["http","https"].indexOf((n=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");if(!t)throw new i.AuthError("You must provide a password");a=void 0,h=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.getMembership(r)];case 2:return a=o.sent(),h=a.all_nodes[0],[3,4];case 3:if((l=o.sent()).error&&"illegal_database_name"===l.error)throw l;return h=void 0,[3,4];case 4:return d=f(0,h),p=(r.configUrl||d)+"/admins/"+encodeURIComponent(e),y=c.assign({method:"PUT",processData:!1,headers:u.getBasicAuthHeaders(n),body:'"'+t+'"'},r.ajax||{}),[4,s.doFetch(n,p,y)];case 5:return[2,o.sent()];case 6:throw o.sent();case 7:return[2]}})})},t.deleteAdmin=function(e,t){return n(this,void 0,void 0,function(){var r,n,a,h,l,d,p;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),-1===["http","https"].indexOf((r=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");n=void 0,a=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r.getMembership(t)];case 2:return n=o.sent(),a=n.all_nodes[0],[3,4];case 3:if((h=o.sent()).error&&"illegal_database_name"===h.error)throw h;return a=void 0,[3,4];case 4:return l=f(0,a),d=(t.configUrl||l)+"/admins/"+encodeURIComponent(e),p=c.assign({method:"DELETE",processData:!1,headers:u.getBasicAuthHeaders(r)},t.ajax||{}),[4,s.doFetch(r,d,p)];case 5:return[2,o.sent()];case 6:throw o.sent();case 7:return[2]}})})}},function(e,t,r){"use strict";r.r(t),r.d(t,"fetch",function(){return o}),r.d(t,"Headers",function(){return i}),r.d(t,"AbortController",function(){return n});var n="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},o=fetch,i=Headers},function(e,t,r){var n,o,i=r(10),s=r(11),u=0,a=0;e.exports=function(e,t,r){var c=t&&r||0,f=t||[],h=(e=e||{}).node||n,l=void 0!==e.clockseq?e.clockseq:o;if(null==h||null==l){var d=i();null==h&&(h=n=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==l&&(l=o=16383&(d[6]<<8|d[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:a+1,v=p-u+(y-a)/1e4;if(v<0&&void 0===e.clockseq&&(l=l+1&16383),(v<0||p>u)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=p,a=y,o=l;var w=(1e4*(268435455&(p+=122192928e5))+y)%4294967296;f[c++]=w>>>24&255,f[c++]=w>>>16&255,f[c++]=w>>>8&255,f[c++]=255&w;var b=p/4294967296*1e4&268435455;f[c++]=b>>>8&255,f[c++]=255&b,f[c++]=b>>>24&15|16,f[c++]=b>>>16&255,f[c++]=l>>>8|128,f[c++]=255&l;for(var g=0;g<6;++g)f[c+g]=h[g];return t||s(f)}},function(e,t,r){var n=r(10),o=r(11);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var s=(e=e||{}).random||(e.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var u=0;u<16;++u)t[i+u]=s[u];return t||o(s)}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,u)}a((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function r(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,o=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}var n,o,i,s,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=r(0),u=r(1);t.logIn=function(e,t,r){return n(this,void 0,void 0,function(){var n,a;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),-1===["http","https"].indexOf((n=this).type()))throw new Error("pouchdb-authentication plugin only works for the http/https adapter");if(!e)throw new Error("you must provide a username");if(!t)throw new Error("you must provide a password");return a=u.assign({method:"POST",headers:u.assign({"Content-Type":"application/json"},s.getBasicAuthHeaders(n)),body:{name:e,password:t}},r.ajax||{}),[4,i.doFetch(n,"/_session",a)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},t.logOut=function(e){return n(this,void 0,void 0,function(){var t,r;return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,r=u.assign({method:"DELETE",headers:s.getBasicAuthHeaders(t)},e.ajax||{}),[4,i.doFetch(t,"/_session",r)];case 1:return[2,n.sent()];case 2:throw n.sent();case 3:return[2]}})})},t.getSession=function(){return n(this,void 0,void 0,function(){var e,t;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=this,t={method:"GET",headers:s.getBasicAuthHeaders(e)},[4,i.doFetch(e,"/_session",t)];case 1:return[2,r.sent()];case 2:throw r.sent();case 3:return[2]}})})}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new r(function(t){t(e.value)}).then(s,u)}a((n=n.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function r(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,o&&(i=2&r[0]?o.return:r[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,r[1])).done)return i;switch(o=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,o=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(!(i=(i=u.trys).length>0&&i[i.length-1])&&(6===r[0]||2===r[0])){u=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){u.label=r[1];break}if(6===r[0]&&u.label<i[1]){u.label=i[1],i=r;break}if(i&&u.label<i[2]){u.label=i[2],u.ops.push(r);break}i[2]&&u.ops.pop(),u.trys.pop();continue}r=t.call(e,u)}catch(e){r=[6,e],o=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}var n,o,i,s,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),s=r(0),u=r(0),a=r(0),c=r(1),f=r(1);t.getUsersDatabaseUrl=function(){return a.getBaseUrl(this)+"/_users"};var h=function(e,t,r){return n(this,void 0,void 0,function(){var n,a,f,h;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),n=["_id","_rev","name","type","roles","password","password_scheme","iterations","derived_key","salt"],r.metadata){for(a in r.metadata)if(r.metadata.hasOwnProperty(a)&&-1!==n.indexOf(a))throw new i.AuthError('cannot use reserved word in metadata: "'+a+'"');t=c.assign(t,r.metadata)}return r.roles&&(t=c.assign(t,{roles:r.roles})),f="/_users/"+encodeURIComponent(t._id),h=c.assign({method:"PUT",body:t,headers:u.getBasicAuthHeaders(e)},r.ajax||{}),[4,s.doFetch(e,f,h)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})};t.signUp=function(e,t,r){return n(this,void 0,void 0,function(){var n;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),-1===["http","https"].indexOf((n=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");if(!t)throw new i.AuthError("You must provide a password");return[4,h(n,{name:e,password:t,roles:[],type:"user",_id:"org.couchdb.user:"+e},r)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},t.getUser=function(e,t){return n(this,void 0,void 0,function(){var r,n,a;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),r=this,!e)throw new i.AuthError("you must provide a username");return n="/_users/"+encodeURIComponent("org.couchdb.user:"+e),a=c.assign({method:"GET",headers:u.getBasicAuthHeaders(r)},t.ajax||{}),[4,s.doFetch(r,n,a)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},t.putUser=function(e,t){return n(this,void 0,void 0,function(){var r,n;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),-1===["http","https"].indexOf((r=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");return[4,r.getUser(e,t)];case 1:return n=o.sent(),[4,h(r,n,t)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}})})},t.deleteUser=function(e,t){return n(this,void 0,void 0,function(){var r,n,a,f;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),-1===["http","https"].indexOf((r=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");return[4,r.getUser(e,t)];case 1:return n=o.sent(),a="/_users/"+encodeURIComponent(n._id)+"?rev="+n._rev,f=c.assign({method:"DELETE",headers:u.getBasicAuthHeaders(r)},t.ajax||{}),[4,s.doFetch(r,a,f)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}})})},t.changePassword=function(e,t,r){return n(this,void 0,void 0,function(){var n,a,f,h;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),-1===["http","https"].indexOf((n=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw new i.AuthError("You must provide a username");if(!t)throw new i.AuthError("You must provide a password");return[4,n.getUser(e,r)];case 1:return(a=o.sent()).password=t,f="/_users/"+encodeURIComponent(a._id),h=c.assign({method:"PUT",headers:u.getBasicAuthHeaders(n),body:a},r.ajax||{}),[4,s.doFetch(n,f,h)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}})})},t.changeUsername=function(e,t,r){return n(this,void 0,void 0,function(){var a,h,l,d,p,y,v;return o(this,function(w){switch(w.label){case 0:if(w.trys.push([0,11,,12]),a=this,h="org.couchdb.user:",l=function(e,t){return n(this,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,s.doFetch(a,e,t)];case 1:return[2,r.sent()];case 2:throw r.sent();case 3:return[2]}})})},d=function(e,t){return n(this,void 0,void 0,function(){var r,n;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r="/_users/"+encodeURIComponent(e._id),n=c.assign({method:"PUT",headers:u.getBasicAuthHeaders(a),body:e},t.ajax||{}),[4,l(r,n)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},r.ajax=r.ajax||{},-1===["http","https"].indexOf(a.type()))throw p=new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!t)throw p=new i.AuthError("You must provide a new username");if(!e)throw p=new i.AuthError("You must provide a username to rename");w.label=1;case 1:return w.trys.push([1,3,,10]),[4,a.getUser(t,r)];case 2:throw w.sent(),(p=new i.AuthError("user already exists")).taken=!0,p;case 3:w.sent(),w.label=4;case 4:return w.trys.push([4,8,,9]),[4,a.getUser(e,r)];case 5:return y=w.sent(),delete(v=f.clone(y))._rev,v._id=h+t,v.name=t,v.roles=r.roles||y.roles||[],[4,d(v,r)];case 6:return w.sent(),y._deleted=!0,[4,d(y,r)];case 7:return[2,w.sent()];case 8:throw w.sent();case 9:return[3,10];case 10:return[3,12];case 11:throw w.sent();case 12:return[2]}})})}}])},{}]},{},[1])(1)});
