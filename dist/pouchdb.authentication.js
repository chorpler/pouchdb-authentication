(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.PouchAuthentication = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="build/",r(r.s=13)}([function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function s(t){try{a(n.next(t))}catch(t){i(t)}}function u(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(s,u)}a((n=n.apply(t,e||[])).next())})},s=this&&this.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var u=r(3),a=r(16),c=r(1);e.getBaseUrl=function(t){var e;if(t&&t.prefix){var r=t.prefix;e=r+(r.endsWith("/")?"":"/")+t.name}else e=t.name;var n=c.parseUri(e),o=n.path,i=(o.endsWith("/")?o.substr(0,-1):o).split("/").slice(0,-1).join("/");return n.protocol+"://"+n.host+(n.port?":"+n.port:"")+i},e.getBasicAuthHeaders=function(t){var e;if(t.__opts&&t.__opts.auth)e=t.__opts.auth;else{var r=c.parseUri(t.name);(r.user||r.password)&&(e={username:r.user,password:r.password})}if(!e)return new a.Headers;var n=e.username+":"+e.password,o=u.btoa(decodeURIComponent(encodeURIComponent(n))),i=new a.Headers;return i.set("Authorization","Basic "+o),i},e.doFetch=function(t,e,r){return i(this,void 0,void 0,function(){var n,o,i,u,a;return s(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),r=c.assign(r||{}),n=e,r.body&&"string"!=typeof r.body&&(r.body=JSON.stringify(r.body)),[4,t.fetch(n,r)];case 1:return o=s.sent(),i=o.ok,[4,o.json()];case 2:if(u=s.sent(),i)return[2,u];throw new Error("fetch result not ok");case 3:throw(a=s.sent())&&"unknown_error"===a.name&&(a.message=(a.message+" "||!1)+"Unknown error!  Did you remember to enable CORS?"),a;case 4:return[2]}})})};var f=function(t){function e(e){var r=t.call(this,e)||this;return r.status=400,r.name="authentication_error",r.message="",r.error=!0,r.taken=!1,e&&(r.message=e),Error.captureStackTrace(r),r}return o(e,t),e}(Error);e.AuthError=f},function(t,e,r){"use strict";r.r(e);var n,o=r(5),i=r.n(o);function s(t){return"$"+t}function u(t){return t.substring(1)}function a(){this._store={}}function c(t){if(this._store=new a,t&&Array.isArray(t))for(var e=0,r=t.length;e<r;e++)this.add(t[e])}a.prototype.get=function(t){var e=s(t);return this._store[e]},a.prototype.set=function(t,e){var r=s(t);return this._store[r]=e,!0},a.prototype.has=function(t){return s(t)in this._store},a.prototype.delete=function(t){var e=s(t),r=e in this._store;return delete this._store[e],r},a.prototype.forEach=function(t){for(var e=Object.keys(this._store),r=0,n=e.length;r<n;r++){var o=e[r];t(this._store[o],o=u(o))}},Object.defineProperty(a.prototype,"size",{get:function(){return Object.keys(this._store).length}}),c.prototype.add=function(t){return this._store.set(t,!0)},c.prototype.has=function(t){return this._store.has(t)},c.prototype.forEach=function(t){this._store.forEach(function(e,r){t(r)})},Object.defineProperty(c.prototype,"size",{get:function(){return this._store.size}}),!function(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var t=Object.getOwnPropertyDescriptor(Map,Symbol.species);return t&&"get"in t&&Map[Symbol.species]===Map}()?(c,n=a):(Set,n=Map);var f=r(7),h=r.n(f),l=r(2),d=r(4),p=r.n(d);function y(t,e,r){Error.call(this,r),this.status=t,this.name=e,this.message=r,this.error=!0}p()(y,Error),y.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};new y(401,"unauthorized","Name or password is incorrect."),new y(400,"bad_request","Missing JSON list of 'docs'"),new y(404,"not_found","missing"),new y(409,"conflict","Document update conflict");var v=new y(400,"bad_request","_id field must contain a string"),w=new y(412,"missing_id","_id is required for puts"),b=new y(400,"bad_request","Only reserved document ids may start with underscore."),_=(new y(412,"precondition_failed","Database not open"),new y(500,"unknown_error","Database encountered an unknown error"),new y(500,"badarg","Some query argument is invalid"),new y(400,"invalid_request","Request was invalid"),new y(400,"query_parse_error","Some query parameter is invalid"),new y(500,"doc_validation","Bad special document member"),new y(400,"bad_request","Something wrong with the request"));new y(400,"bad_request","Document must be a JSON object"),new y(404,"not_found","Database not found"),new y(500,"indexed_db_went_bad","unknown"),new y(500,"web_sql_went_bad","unknown"),new y(500,"levelDB_went_went_bad","unknown"),new y(403,"forbidden","Forbidden by design doc validate_doc_update function"),new y(400,"bad_request","Invalid rev format"),new y(412,"file_exists","The database could not be created, the file already exists."),new y(412,"missing_stub","A pre-existing attachment stub wasn't found"),new y(413,"invalid_url","Provided URL is invalid");function m(t,e){function r(e){for(var r in t)"function"!=typeof t[r]&&(this[r]=t[r]);void 0!==e&&(this.reason=e)}return r.prototype=y.prototype,new r(e)}var g=r(8),A=r.n(g),B=r(12);function S(t){if(t instanceof ArrayBuffer)return function(t){if("function"==typeof t.slice)return t.slice(0);var e=new ArrayBuffer(t.byteLength),r=new Uint8Array(e),n=new Uint8Array(t);return r.set(n),e}(t);var e=t.size,r=t.type;return"function"==typeof t.slice?t.slice(0,e,r):t.webkitSlice(0,e,r)}r.d(e,"adapterFun",function(){return j}),r.d(e,"assign",function(){return N}),r.d(e,"bulkGetShim",function(){return I}),r.d(e,"changesHandler",function(){return q}),r.d(e,"clone",function(){return E}),r.d(e,"defaultBackOff",function(){return R}),r.d(e,"explainError",function(){return H}),r.d(e,"filterChange",function(){return Y}),r.d(e,"flatten",function(){return z}),r.d(e,"functionName",function(){return G}),r.d(e,"guardedConsole",function(){return F}),r.d(e,"hasLocalStorage",function(){return D}),r.d(e,"invalidIdError",function(){return W}),r.d(e,"isRemote",function(){return J}),r.d(e,"listenerCount",function(){return $}),r.d(e,"normalizeDdocFunctionName",function(){return Q}),r.d(e,"once",function(){return O}),r.d(e,"parseDdocFunctionName",function(){return K}),r.d(e,"parseUri",function(){return et}),r.d(e,"pick",function(){return k}),r.d(e,"rev",function(){return ot}),r.d(e,"scopeEval",function(){return rt}),r.d(e,"toPromise",function(){return P}),r.d(e,"upsert",function(){return nt}),r.d(e,"uuid",function(){return it}),r.d(e,"nextTick",function(){return h.a});var U=Function.prototype.toString,x=U.call(Object);function E(t){var e,r,n;if(!t||"object"!=typeof t)return t;if(Array.isArray(t)){for(e=[],r=0,n=t.length;r<n;r++)e[r]=E(t[r]);return e}if(t instanceof Date)return t.toISOString();if(function(t){return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer||"undefined"!=typeof Blob&&t instanceof Blob}(t))return S(t);if(!function(t){var e=Object.getPrototypeOf(t);if(null===e)return!0;var r=e.constructor;return"function"==typeof r&&r instanceof r&&U.call(r)==x}(t))return t;for(r in e={},t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=E(t[r]);void 0!==o&&(e[r]=o)}return e}function O(t){var e=!1;return i()(function(r){if(e)throw new Error("once called more than once");e=!0,t.apply(this,r)})}function P(t){return i()(function(e){e=E(e);var r=this,n="function"==typeof e[e.length-1]&&e.pop(),o=new Promise(function(n,o){var i;try{var s=O(function(t,e){t?o(t):n(e)});e.push(s),(i=t.apply(r,e))&&"function"==typeof i.then&&n(i)}catch(t){o(t)}});return n&&o.then(function(t){n(null,t)},n),o})}function j(t,e){return P(i()(function(r){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var n=this;return function(t,e,r){if(t.constructor.listeners("debug").length){for(var n=["api",t.name,e],o=0;o<r.length-1;o++)n.push(r[o]);t.constructor.emit("debug",n);var i=r[r.length-1];r[r.length-1]=function(r,n){var o=["api",t.name,e];o=o.concat(r?["error",r]:["success",n]),t.constructor.emit("debug",o),i(r,n)}}}(n,t,r),this.taskqueue.isReady?e.apply(this,r):new Promise(function(e,o){n.taskqueue.addTask(function(i){i?o(i):e(n[t].apply(n,r))})})}))}function k(t,e){for(var r={},n=0,o=e.length;n<o;n++){var i=e[n];i in t&&(r[i]=t[i])}return r}var C,L=6;function M(t){return t}function T(t){return[{ok:t}]}function I(t,e,r){var o=e.docs,i=new n;o.forEach(function(t){i.has(t.id)?i.get(t.id).push(t):i.set(t.id,[t])});var s=i.size,u=0,a=new Array(s);function c(){var t;++u===s&&(t=[],a.forEach(function(e){e.docs.forEach(function(r){t.push({id:e.id,docs:[r]})})}),r(null,{results:t}))}var f=[];i.forEach(function(t,e){f.push(e)});var h=0;function l(){if(!(h>=f.length)){var r=Math.min(h+L,f.length),n=f.slice(h,r);!function(r,n){r.forEach(function(r,o){var s=n+o,u=i.get(r),f=k(u[0],["atts_since","attachments"]);f.open_revs=u.map(function(t){return t.rev}),f.open_revs=f.open_revs.filter(M);var h=M;0===f.open_revs.length&&(delete f.open_revs,h=T),["revs","attachments","binary","ajax","latest"].forEach(function(t){t in e&&(f[t]=e[t])}),t.get(r,f,function(t,e){var n,o,i;n=t?[{error:t}]:h(e),o=r,i=n,a[s]={id:o,docs:i},c(),l()})})}(n,h),h+=n.length}}l()}try{localStorage.setItem("_pouch_check_localstorage",1),C=!!localStorage.getItem("_pouch_check_localstorage")}catch(t){C=!1}function D(){return C}function q(){var t;l.EventEmitter.call(this),this._listeners={},t=this,D()&&addEventListener("storage",function(e){t.emit(e.key)})}function F(t){if("undefined"!=typeof console&&"function"==typeof console[t]){var e=Array.prototype.slice.call(arguments,1);console[t].apply(console,e)}}function R(t){var e=0;return t||(e=2e3),function(t,e){return t=parseInt(t,10)||0,(e=parseInt(e,10))!=e||e<=t?e=(t||1)<<1:e+=1,e>6e5&&(t=3e5,e=6e5),~~((e-t)*Math.random()+t)}(t,e)}function H(t,e){F("info","The above "+t+" is totally normal. "+e)}p()(q,l.EventEmitter),q.prototype.addListener=function(t,e,r,n){if(!this._listeners[e]){var o=this,i=!1;this._listeners[e]=s,this.on(t,s)}function s(){if(o._listeners[e])if(i)i="waiting";else{i=!0;var t=k(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);r.changes(t).on("change",function(t){t.seq>n.since&&!n.cancelled&&(n.since=t.seq,n.onChange(t))}).on("complete",function(){"waiting"===i&&h()(s),i=!1}).on("error",function(){i=!1})}}},q.prototype.removeListener=function(t,e){e in this._listeners&&(l.EventEmitter.prototype.removeListener.call(this,t,this._listeners[e]),delete this._listeners[e])},q.prototype.notifyLocalWindows=function(t){D()&&(localStorage[t]="a"===localStorage[t]?"b":"a")},q.prototype.notify=function(t){this.emit(t),this.notifyLocalWindows(t)};var N="function"==typeof Object.assign?Object.assign:function(t){for(var e=Object(t),r=1;r<arguments.length;r++){var n=arguments[r];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};function Y(t){var e={},r=t.filter&&"function"==typeof t.filter;return e.query=t.query_params,function(n){n.doc||(n.doc={});var o=r&&function(t,e,r){try{return!t(e,r)}catch(t){var n="Filter function threw: "+t.toString();return m(_,n)}}(t.filter,n.doc,e);if("object"==typeof o)return o;if(o)return!1;if(t.include_docs){if(!t.attachments)for(var i in n.doc._attachments)n.doc._attachments.hasOwnProperty(i)&&(n.doc._attachments[i].stub=!0)}else delete n.doc;return!0}}function z(t){for(var e=[],r=0,n=t.length;r<n;r++)e=e.concat(t[r]);return e}var G=function(){}.name?function(t){return t.name}:function(t){var e=t.toString().match(/^\s*function\s*(?:(\S+)\s*)?\(/);return e&&e[1]?e[1]:""};function W(t){var e;if(t?"string"!=typeof t?e=m(v):/^_/.test(t)&&!/^_(design|local)/.test(t)&&(e=m(b)):e=m(w),e)throw e}function J(t){return"boolean"==typeof t._remote?t._remote:"function"==typeof t.type&&(F("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===t.type())}function $(t,e){return"listenerCount"in t?t.listenerCount(e):l.EventEmitter.listenerCount(t,e)}function K(t){if(!t)return null;var e=t.split("/");return 2===e.length?e:1===e.length?[t,t]:null}function Q(t){var e=K(t);return e?e.join("/"):null}var V=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],X="queryKey",Z=/(?:^|&)([^&=]*)=?([^&]*)/g,tt=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function et(t){for(var e=tt.exec(t),r={},n=14;n--;){var o=V[n],i=e[n]||"",s=-1!==["user","password"].indexOf(o);r[o]=s?decodeURIComponent(i):i}return r[X]={},r[V[12]].replace(Z,function(t,e,n){e&&(r[X][e]=n)}),r}function rt(t,e){var r=[],n=[];for(var o in e)e.hasOwnProperty(o)&&(r.push(o),n.push(e[o]));return r.push(t),Function.apply(null,r).apply(null,n)}function nt(t,e,r){return new Promise(function(n,o){t.get(e,function(i,s){if(i){if(404!==i.status)return o(i);s={}}var u=s._rev,a=r(s);if(!a)return n({updated:!1,rev:u});a._id=e,a._rev=u,n(function(t,e,r){return t.put(e).then(function(t){return{updated:!0,rev:t.rev}},function(n){if(409!==n.status)throw n;return nt(t,e._id,r)})}(t,a,r))})})}function ot(t,e){var r=E(t);return e?(delete r._rev_tree,Object(B.a)(JSON.stringify(r))):A.a.v4().replace(/-/g,"").toLowerCase()}var it=A.a.v4},function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function o(t){return"object"==typeof t&&null!==t}function i(t){return void 0===t}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,s,u,a,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var f=new Error('Uncaught, unspecified "error" event. ('+e+")");throw f.context=e,f}if(i(r=this._events[t]))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),r.apply(this,u)}else if(o(r))for(u=Array.prototype.slice.call(arguments,1),s=(c=r.slice()).length,a=0;a<s;a++)c[a].apply(this,u);return!0},r.prototype.addListener=function(t,e){var s;if(!n(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(s=i(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[t].length>s&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){if(!n(e))throw TypeError("listener must be a function");var r=!1;function o(){this.removeListener(t,o),r||(r=!0,e.apply(this,arguments))}return o.listener=e,this.on(t,o),this},r.prototype.removeListener=function(t,e){var r,i,s,u;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=(r=this._events[t]).length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(r)){for(u=s;u-- >0;)if(r[u]===e||r[u].listener&&r[u].listener===e){i=u;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n(r=this._events[t]))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(n(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,r){"use strict";r.r(e),r.d(e,"atob",function(){return n}),r.d(e,"btoa",function(){return o}),r.d(e,"base64StringToBlobOrBuffer",function(){return a}),r.d(e,"binaryStringToArrayBuffer",function(){return s}),r.d(e,"binaryStringToBlobOrBuffer",function(){return u}),r.d(e,"blob",function(){return i}),r.d(e,"blobOrBufferToBase64",function(){return h}),r.d(e,"blobOrBufferToBinaryString",function(){return f}),r.d(e,"readAsArrayBuffer",function(){return l}),r.d(e,"readAsBinaryString",function(){return c}),r.d(e,"typedBuffer",function(){return d});var n=function(t){return atob(t)},o=function(t){return btoa(t)};function i(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<t.length;n+=1)r.append(t[n]);return r.getBlob(e.type)}}function s(t){for(var e=t.length,r=new ArrayBuffer(e),n=new Uint8Array(r),o=0;o<e;o++)n[o]=t.charCodeAt(o);return r}function u(t,e){return i([s(t)],{type:e})}function a(t,e){return u(n(t),e)}function c(t,e){var r=new FileReader,n="function"==typeof r.readAsBinaryString;r.onloadend=function(t){var r=t.target.result||"";if(n)return e(r);e(function(t){for(var e="",r=new Uint8Array(t),n=r.byteLength,o=0;o<n;o++)e+=String.fromCharCode(r[o]);return e}(r))},n?r.readAsBinaryString(t):r.readAsArrayBuffer(t)}function f(t,e){c(t,function(t){e(t)})}function h(t,e){f(t,function(t){e(o(t))})}function l(t,e){var r=new FileReader;r.onloadend=function(t){var r=t.target.result||new ArrayBuffer(0);e(r)},r.readAsArrayBuffer(t)}function d(){}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";t.exports=function(t){return function(){var e=arguments.length;if(e){for(var r=[],n=-1;++n<e;)r[n]=arguments[n];return t.call(this,r)}return t.call(this,[])}}},function(t,e,r){t.exports=function(t){"use strict";var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function r(t,e){var r=t[0],n=t[1],o=t[2],i=t[3];r+=(n&o|~n&i)+e[0]-680876936|0,i+=((r=(r<<7|r>>>25)+n|0)&n|~r&o)+e[1]-389564586|0,o+=((i=(i<<12|i>>>20)+r|0)&r|~i&n)+e[2]+606105819|0,n+=((o=(o<<17|o>>>15)+i|0)&i|~o&r)+e[3]-1044525330|0,r+=((n=(n<<22|n>>>10)+o|0)&o|~n&i)+e[4]-176418897|0,i+=((r=(r<<7|r>>>25)+n|0)&n|~r&o)+e[5]+1200080426|0,o+=((i=(i<<12|i>>>20)+r|0)&r|~i&n)+e[6]-1473231341|0,n+=((o=(o<<17|o>>>15)+i|0)&i|~o&r)+e[7]-45705983|0,r+=((n=(n<<22|n>>>10)+o|0)&o|~n&i)+e[8]+1770035416|0,i+=((r=(r<<7|r>>>25)+n|0)&n|~r&o)+e[9]-1958414417|0,o+=((i=(i<<12|i>>>20)+r|0)&r|~i&n)+e[10]-42063|0,n+=((o=(o<<17|o>>>15)+i|0)&i|~o&r)+e[11]-1990404162|0,r+=((n=(n<<22|n>>>10)+o|0)&o|~n&i)+e[12]+1804603682|0,i+=((r=(r<<7|r>>>25)+n|0)&n|~r&o)+e[13]-40341101|0,o+=((i=(i<<12|i>>>20)+r|0)&r|~i&n)+e[14]-1502002290|0,n+=((o=(o<<17|o>>>15)+i|0)&i|~o&r)+e[15]+1236535329|0,r+=((n=(n<<22|n>>>10)+o|0)&i|o&~i)+e[1]-165796510|0,i+=((r=(r<<5|r>>>27)+n|0)&o|n&~o)+e[6]-1069501632|0,o+=((i=(i<<9|i>>>23)+r|0)&n|r&~n)+e[11]+643717713|0,n+=((o=(o<<14|o>>>18)+i|0)&r|i&~r)+e[0]-373897302|0,r+=((n=(n<<20|n>>>12)+o|0)&i|o&~i)+e[5]-701558691|0,i+=((r=(r<<5|r>>>27)+n|0)&o|n&~o)+e[10]+38016083|0,o+=((i=(i<<9|i>>>23)+r|0)&n|r&~n)+e[15]-660478335|0,n+=((o=(o<<14|o>>>18)+i|0)&r|i&~r)+e[4]-405537848|0,r+=((n=(n<<20|n>>>12)+o|0)&i|o&~i)+e[9]+568446438|0,i+=((r=(r<<5|r>>>27)+n|0)&o|n&~o)+e[14]-1019803690|0,o+=((i=(i<<9|i>>>23)+r|0)&n|r&~n)+e[3]-187363961|0,n+=((o=(o<<14|o>>>18)+i|0)&r|i&~r)+e[8]+1163531501|0,r+=((n=(n<<20|n>>>12)+o|0)&i|o&~i)+e[13]-1444681467|0,i+=((r=(r<<5|r>>>27)+n|0)&o|n&~o)+e[2]-51403784|0,o+=((i=(i<<9|i>>>23)+r|0)&n|r&~n)+e[7]+1735328473|0,n+=((o=(o<<14|o>>>18)+i|0)&r|i&~r)+e[12]-1926607734|0,r+=((n=(n<<20|n>>>12)+o|0)^o^i)+e[5]-378558|0,i+=((r=(r<<4|r>>>28)+n|0)^n^o)+e[8]-2022574463|0,o+=((i=(i<<11|i>>>21)+r|0)^r^n)+e[11]+1839030562|0,n+=((o=(o<<16|o>>>16)+i|0)^i^r)+e[14]-35309556|0,r+=((n=(n<<23|n>>>9)+o|0)^o^i)+e[1]-1530992060|0,i+=((r=(r<<4|r>>>28)+n|0)^n^o)+e[4]+1272893353|0,o+=((i=(i<<11|i>>>21)+r|0)^r^n)+e[7]-155497632|0,n+=((o=(o<<16|o>>>16)+i|0)^i^r)+e[10]-1094730640|0,r+=((n=(n<<23|n>>>9)+o|0)^o^i)+e[13]+681279174|0,i+=((r=(r<<4|r>>>28)+n|0)^n^o)+e[0]-358537222|0,o+=((i=(i<<11|i>>>21)+r|0)^r^n)+e[3]-722521979|0,n+=((o=(o<<16|o>>>16)+i|0)^i^r)+e[6]+76029189|0,r+=((n=(n<<23|n>>>9)+o|0)^o^i)+e[9]-640364487|0,i+=((r=(r<<4|r>>>28)+n|0)^n^o)+e[12]-421815835|0,o+=((i=(i<<11|i>>>21)+r|0)^r^n)+e[15]+530742520|0,n+=((o=(o<<16|o>>>16)+i|0)^i^r)+e[2]-995338651|0,r+=(o^((n=(n<<23|n>>>9)+o|0)|~i))+e[0]-198630844|0,i+=(n^((r=(r<<6|r>>>26)+n|0)|~o))+e[7]+1126891415|0,o+=(r^((i=(i<<10|i>>>22)+r|0)|~n))+e[14]-1416354905|0,n+=(i^((o=(o<<15|o>>>17)+i|0)|~r))+e[5]-57434055|0,r+=(o^((n=(n<<21|n>>>11)+o|0)|~i))+e[12]+1700485571|0,i+=(n^((r=(r<<6|r>>>26)+n|0)|~o))+e[3]-1894986606|0,o+=(r^((i=(i<<10|i>>>22)+r|0)|~n))+e[10]-1051523|0,n+=(i^((o=(o<<15|o>>>17)+i|0)|~r))+e[1]-2054922799|0,r+=(o^((n=(n<<21|n>>>11)+o|0)|~i))+e[8]+1873313359|0,i+=(n^((r=(r<<6|r>>>26)+n|0)|~o))+e[15]-30611744|0,o+=(r^((i=(i<<10|i>>>22)+r|0)|~n))+e[6]-1560198380|0,n+=(i^((o=(o<<15|o>>>17)+i|0)|~r))+e[13]+1309151649|0,r+=(o^((n=(n<<21|n>>>11)+o|0)|~i))+e[4]-145523070|0,i+=(n^((r=(r<<6|r>>>26)+n|0)|~o))+e[11]-1120210379|0,o+=(r^((i=(i<<10|i>>>22)+r|0)|~n))+e[2]+718787259|0,n=((n+=(i^((o=(o<<15|o>>>17)+i|0)|~r))+e[9]-343485551|0)<<21|n>>>11)+o|0,t[0]=r+t[0]|0,t[1]=n+t[1]|0,t[2]=o+t[2]|0,t[3]=i+t[3]|0}function n(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}function o(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return r}function i(t){var e,o,i,s,u,a,c=t.length,f=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)r(f,n(t.substring(e-64,e)));for(t=t.substring(e-64),o=t.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<o;e+=1)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(r(f,i),e=0;e<16;e+=1)i[e]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),u=parseInt(s[2],16),a=parseInt(s[1],16)||0,i[14]=u,i[15]=a,r(f,i),f}function s(t){var r,n="";for(r=0;r<4;r+=1)n+=e[t>>8*r+4&15]+e[t>>8*r&15];return n}function u(t){var e;for(e=0;e<t.length;e+=1)t[e]=s(t[e]);return t.join("")}function a(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function c(t){var e,r=[],n=t.length;for(e=0;e<n-1;e+=2)r.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,r)}function f(){this.reset()}return u(i("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return(t=0|t||0)<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(r,n){var o,i,s,u,a=this.byteLength,c=e(r,a),f=a;return n!==t&&(f=e(n,a)),c>f?new ArrayBuffer(0):(o=f-c,i=new ArrayBuffer(o),s=new Uint8Array(i),u=new Uint8Array(this,c,o),s.set(u),i)}}(),f.prototype.append=function(t){return this.appendBinary(a(t)),this},f.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,o=this._buff.length;for(e=64;e<=o;e+=64)r(this._hash,n(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},f.prototype.end=function(t){var e,r,n=this._buff,o=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<o;e+=1)i[e>>2]|=n.charCodeAt(e)<<(e%4<<3);return this._finish(i,o),r=u(this._hash),t&&(r=c(r)),this.reset(),r},f.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},f.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},f.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},f.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},f.prototype._finish=function(t,e){var n,o,i,s=e;if(t[s>>2]|=128<<(s%4<<3),s>55)for(r(this._hash,t),s=0;s<16;s+=1)t[s]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(n[2],16),i=parseInt(n[1],16)||0,t[14]=o,t[15]=i,r(this._hash,t)},f.hash=function(t,e){return f.hashBinary(a(t),e)},f.hashBinary=function(t,e){var r=u(i(t));return e?c(r):r},f.ArrayBuffer=function(){this.reset()},f.ArrayBuffer.prototype.append=function(t){var e,n,i,s,u,a=(n=this._buff.buffer,i=t,s=!0,(u=new Uint8Array(n.byteLength+i.byteLength)).set(new Uint8Array(n)),u.set(new Uint8Array(i),n.byteLength),s?u:u.buffer),c=a.length;for(this._length+=t.byteLength,e=64;e<=c;e+=64)r(this._hash,o(a.subarray(e-64,e)));return this._buff=e-64<c?new Uint8Array(a.buffer.slice(e-64)):new Uint8Array(0),this},f.ArrayBuffer.prototype.end=function(t){var e,r,n=this._buff,o=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<o;e+=1)i[e>>2]|=n[e]<<(e%4<<3);return this._finish(i,o),r=u(this._hash),t&&(r=c(r)),this.reset(),r},f.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},f.ArrayBuffer.prototype.getState=function(){var t,e=f.prototype.getState.call(this);return e.buff=(t=e.buff,String.fromCharCode.apply(null,new Uint8Array(t))),e},f.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t,e){var r,n=t.length,o=new ArrayBuffer(n),i=new Uint8Array(o);for(r=0;r<n;r+=1)i[r]=t.charCodeAt(r);return e?i:o}(t.buff,!0),f.prototype.setState.call(this,t)},f.ArrayBuffer.prototype.destroy=f.prototype.destroy,f.ArrayBuffer.prototype._finish=f.prototype._finish,f.ArrayBuffer.hash=function(t,e){var n=u(function(t){var e,n,i,s,u,a,c=t.length,f=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)r(f,o(t.subarray(e-64,e)));for(t=e-64<c?t.subarray(e-64):new Uint8Array(0),n=t.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<n;e+=1)i[e>>2]|=t[e]<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(r(f,i),e=0;e<16;e+=1)i[e]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),u=parseInt(s[2],16),a=parseInt(s[1],16)||0,i[14]=u,i[15]=a,r(f,i),f}(new Uint8Array(t)));return e?c(n):n},f}()},function(t,e,r){"use strict";(function(e){var r,n,o=e.MutationObserver||e.WebKitMutationObserver;if(o){var i=0,s=new o(f),u=e.document.createTextNode("");s.observe(u,{characterData:!0}),r=function(){u.data=i=++i%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){f(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(f,0)};else{var a=new e.MessageChannel;a.port1.onmessage=f,r=function(){a.port2.postMessage(0)}}var c=[];function f(){var t,e;n=!0;for(var r=c.length;r;){for(e=c,c=[],t=-1;++t<r;)e[t]();r=c.length}n=!1}t.exports=function(t){1!==c.push(t)||n||r()}}).call(this,r(9))},function(t,e,r){var n=r(17),o=r(18),i=o;i.v1=n,i.v4=o,t.exports=i},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){var r="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);t.exports=function(){return r(n),n}}else{var o=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}},function(t,e){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);t.exports=function(t,e){var n=e||0,o=r;return o[t[n++]]+o[t[n++]]+o[t[n++]]+o[t[n++]]+"-"+o[t[n++]]+o[t[n++]]+"-"+o[t[n++]]+o[t[n++]]+"-"+o[t[n++]]+o[t[n++]]+"-"+o[t[n++]]+o[t[n++]]+o[t[n++]]+o[t[n++]]+o[t[n++]]+o[t[n++]]}},function(t,e,r){"use strict";(function(t){r.d(e,"a",function(){return i});r(3);var n=r(6),o=r.n(n);t.setImmediate||t.setTimeout;function i(t){return o.a.hash(t)}}).call(this,r(9))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(14);e.default=n.PouchDBAuthPlugin},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(15),o=r(19),i=r(20);e.PouchDBAuthPlugin={login:o.logIn,logIn:o.logIn,logout:o.logOut,logOut:o.logOut,getSession:o.getSession,getMembership:n.getMembership,signUpAdmin:n.signUpAdmin,deleteAdmin:n.deleteAdmin,getUsersDatabaseUrl:i.getUsersDatabaseUrl,signup:i.signUp,signUp:i.signUp,getUser:i.getUser,putUser:i.putUser,deleteUser:i.deleteUser,changePassword:i.changePassword,changeUsername:i.changeUsername},"undefined"!=typeof window&&window.PouchDB&&window.PouchDB.plugin(e.PouchDBAuthPlugin)},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function s(t){try{a(n.next(t))}catch(t){i(t)}}function u(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(s,u)}a((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(0),s=r(0),u=r(0),a=r(0),c=r(1),f=function(t,e){return(e?"/_node/"+e:"")+"/_config"};e.getMembership=function(t){return n(this,void 0,void 0,function(){var e,r,n,i;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),e=this,r=a.getBaseUrl(e),n=r+"/_membership",i=c.assign({method:"GET",headers:u.getBasicAuthHeaders(e)},t.ajax||{}),[4,s.doFetch(e,n,i)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})};e.signUpAdmin=function(t,e,r){return n(this,void 0,void 0,function(){var n,a,h,l,d,p,y;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),-1===["http","https"].indexOf((n=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!t)throw new i.AuthError("You must provide a username");if(!e)throw new i.AuthError("You must provide a password");a=void 0,h=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.getMembership(r)];case 2:return a=o.sent(),h=a.all_nodes[0],[3,4];case 3:if((l=o.sent()).error&&"illegal_database_name"===l.error)throw l;return h=void 0,[3,4];case 4:return d=f(0,h),p=(r.configUrl||d)+"/admins/"+encodeURIComponent(t),y=c.assign({method:"PUT",processData:!1,headers:u.getBasicAuthHeaders(n),body:'"'+e+'"'},r.ajax||{}),[4,s.doFetch(n,p,y)];case 5:return[2,o.sent()];case 6:throw o.sent();case 7:return[2]}})})};e.deleteAdmin=function(t,e){return n(this,void 0,void 0,function(){var r,n,a,h,l,d,p;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,6,,7]),-1===["http","https"].indexOf((r=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!t)throw new i.AuthError("You must provide a username");n=void 0,a=void 0,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,r.getMembership(e)];case 2:return n=o.sent(),a=n.all_nodes[0],[3,4];case 3:if((h=o.sent()).error&&"illegal_database_name"===h.error)throw h;return a=void 0,[3,4];case 4:return l=f(0,a),d=(e.configUrl||l)+"/admins/"+encodeURIComponent(t),p=c.assign({method:"DELETE",processData:!1,headers:u.getBasicAuthHeaders(r)},e.ajax||{}),[4,s.doFetch(r,d,p)];case 5:return[2,o.sent()];case 6:throw o.sent();case 7:return[2]}})})}},function(t,e,r){"use strict";r.r(e),r.d(e,"fetch",function(){return o}),r.d(e,"Headers",function(){return i}),r.d(e,"AbortController",function(){return n});var n="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},o=fetch,i=Headers},function(t,e,r){var n,o,i=r(10),s=r(11),u=0,a=0;t.exports=function(t,e,r){var c=e&&r||0,f=e||[],h=(t=t||{}).node||n,l=void 0!==t.clockseq?t.clockseq:o;if(null==h||null==l){var d=i();null==h&&(h=n=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==l&&(l=o=16383&(d[6]<<8|d[7]))}var p=void 0!==t.msecs?t.msecs:(new Date).getTime(),y=void 0!==t.nsecs?t.nsecs:a+1,v=p-u+(y-a)/1e4;if(v<0&&void 0===t.clockseq&&(l=l+1&16383),(v<0||p>u)&&void 0===t.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=p,a=y,o=l;var w=(1e4*(268435455&(p+=122192928e5))+y)%4294967296;f[c++]=w>>>24&255,f[c++]=w>>>16&255,f[c++]=w>>>8&255,f[c++]=255&w;var b=p/4294967296*1e4&268435455;f[c++]=b>>>8&255,f[c++]=255&b,f[c++]=b>>>24&15|16,f[c++]=b>>>16&255,f[c++]=l>>>8|128,f[c++]=255&l;for(var _=0;_<6;++_)f[c+_]=h[_];return e||s(f)}},function(t,e,r){var n=r(10),o=r(11);t.exports=function(t,e,r){var i=e&&r||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var s=(t=t||{}).random||(t.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e)for(var u=0;u<16;++u)e[i+u]=s[u];return e||o(s)}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function s(t){try{a(n.next(t))}catch(t){i(t)}}function u(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(s,u)}a((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(0),s=r(0),u=r(1);e.logIn=function(t,e,r){return n(this,void 0,void 0,function(){var n,a;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),-1===["http","https"].indexOf((n=this).type()))throw new Error("pouchdb-authentication plugin only works for the http/https adapter");if(!t)throw new Error("you must provide a username");if(!e)throw new Error("you must provide a password");return a=u.assign({method:"POST",headers:u.assign({"Content-Type":"application/json"},s.getBasicAuthHeaders(n)),body:{name:t,password:e}},r.ajax||{}),[4,i.doFetch(n,"/_session",a)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})};e.logOut=function(t){return n(this,void 0,void 0,function(){var e,r;return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=this,r=u.assign({method:"DELETE",headers:s.getBasicAuthHeaders(e)},t.ajax||{}),[4,i.doFetch(e,"/_session",r)];case 1:return[2,n.sent()];case 2:throw n.sent();case 3:return[2]}})})};e.getSession=function(){return n(this,void 0,void 0,function(){var t,e;return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t=this,e={method:"GET",headers:s.getBasicAuthHeaders(t)},[4,i.doFetch(t,"/_session",e)];case 1:return[2,r.sent()];case 2:throw r.sent();case 3:return[2]}})})}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function s(t){try{a(n.next(t))}catch(t){i(t)}}function u(t){try{a(n.throw(t))}catch(t){i(t)}}function a(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(s,u)}a((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var r,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=e.call(t,s)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=r(0),s=r(0),u=r(0),a=r(0),c=r(1),f=r(1);e.getUsersDatabaseUrl=function(){return a.getBaseUrl(this)+"/_users"};var h=function(t,e,r){return n(this,void 0,void 0,function(){var n,a,f,h;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),n=["_id","_rev","name","type","roles","password","password_scheme","iterations","derived_key","salt"],r.metadata){for(a in r.metadata)if(r.metadata.hasOwnProperty(a)&&-1!==n.indexOf(a))throw new i.AuthError('cannot use reserved word in metadata: "'+a+'"');e=c.assign(e,r.metadata)}return r.roles&&(e=c.assign(e,{roles:r.roles})),f="/_users/"+encodeURIComponent(e._id),h=c.assign({method:"PUT",body:e,headers:u.getBasicAuthHeaders(t)},r.ajax||{}),[4,s.doFetch(t,f,h)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})};e.signUp=function(t,e,r){return n(this,void 0,void 0,function(){var n;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),-1===["http","https"].indexOf((n=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!t)throw new i.AuthError("You must provide a username");if(!e)throw new i.AuthError("You must provide a password");return[4,h(n,{name:t,password:e,roles:[],type:"user",_id:"org.couchdb.user:"+t},r)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})};e.getUser=function(t,e){return n(this,void 0,void 0,function(){var r,n,a;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,2,,3]),r=this,!t)throw new i.AuthError("you must provide a username");return n="/_users/"+encodeURIComponent("org.couchdb.user:"+t),a=c.assign({method:"GET",headers:u.getBasicAuthHeaders(r)},e.ajax||{}),[4,s.doFetch(r,n,a)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})};e.putUser=function(t,e){return n(this,void 0,void 0,function(){var r,n;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),-1===["http","https"].indexOf((r=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!t)throw new i.AuthError("You must provide a username");return[4,r.getUser(t,e)];case 1:return n=o.sent(),[4,h(r,n,e)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}})})};e.deleteUser=function(t,e){return n(this,void 0,void 0,function(){var r,n,a,f;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),-1===["http","https"].indexOf((r=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!t)throw new i.AuthError("You must provide a username");return[4,r.getUser(t,e)];case 1:return n=o.sent(),a="/_users/"+encodeURIComponent(n._id)+"?rev="+n._rev,f=c.assign({method:"DELETE",headers:u.getBasicAuthHeaders(r)},e.ajax||{}),[4,s.doFetch(r,a,f)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}})})};e.changePassword=function(t,e,r){return n(this,void 0,void 0,function(){var n,a,f,h;return o(this,function(o){switch(o.label){case 0:if(o.trys.push([0,3,,4]),-1===["http","https"].indexOf((n=this).type()))throw new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!t)throw new i.AuthError("You must provide a username");if(!e)throw new i.AuthError("You must provide a password");return[4,n.getUser(t,r)];case 1:return(a=o.sent()).password=e,f="/_users/"+encodeURIComponent(a._id),h=c.assign({method:"PUT",headers:u.getBasicAuthHeaders(n),body:a},r.ajax||{}),[4,s.doFetch(n,f,h)];case 2:return[2,o.sent()];case 3:throw o.sent();case 4:return[2]}})})};e.changeUsername=function(t,e,r){return n(this,void 0,void 0,function(){var a,h,l,d,p,y,v;return o(this,function(w){switch(w.label){case 0:if(w.trys.push([0,11,,12]),a=this,h="org.couchdb.user:",l=function(t,e){return n(this,void 0,void 0,function(){return o(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,s.doFetch(a,t,e)];case 1:return[2,r.sent()];case 2:throw r.sent();case 3:return[2]}})})},d=function(t,e){return n(this,void 0,void 0,function(){var r,n;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),r="/_users/"+encodeURIComponent(t._id),n=c.assign({method:"PUT",headers:u.getBasicAuthHeaders(a),body:t},e.ajax||{}),[4,l(r,n)];case 1:return[2,o.sent()];case 2:throw o.sent();case 3:return[2]}})})},r.ajax=r.ajax||{},-1===["http","https"].indexOf(a.type()))throw p=new i.AuthError('This plugin only works for the http/https adapter. So you should use new PouchDB("http://mysite.com:5984/mydb") instead.');if(!e)throw p=new i.AuthError("You must provide a new username");if(!t)throw p=new i.AuthError("You must provide a username to rename");w.label=1;case 1:return w.trys.push([1,3,,10]),[4,a.getUser(e,r)];case 2:throw w.sent(),(p=new i.AuthError("user already exists")).taken=!0,p;case 3:w.sent(),w.label=4;case 4:return w.trys.push([4,8,,9]),[4,a.getUser(t,r)];case 5:return y=w.sent(),delete(v=f.clone(y))._rev,v._id=h+e,v.name=e,v.roles=r.roles||y.roles||[],[4,d(v,r)];case 6:return w.sent(),y._deleted=!0,[4,d(y,r)];case 7:return[2,w.sent()];case 8:throw w.sent();case 9:return[3,10];case 10:return[3,12];case 11:throw w.sent();case 12:return[2]}})})}}]);

},{}]},{},[1])(1)
});